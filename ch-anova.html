<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 분산 분석 | R을 이용한 통계 분석 (개정판)</title>
  <meta name="description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 분산 분석 | R을 이용한 통계 분석 (개정판)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 분산 분석 | R을 이용한 통계 분석 (개정판)" />
  
  <meta name="twitter:description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  

<meta name="author" content="김길환" />


<meta name="date" content="2023-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-numericTest.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BTR0YQD3G1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTR0YQD3G1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R을 이용한 통계 분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>일러두기</a></li>
<li class="part"><span><b>I 개요</b></span></li>
<li class="chapter" data-level="1" data-path="ch-statisics.html"><a href="ch-statisics.html"><i class="fa fa-check"></i><b>1</b> 통계 분석이란?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-statisics.html"><a href="ch-statisics.html#sec-descStat"><i class="fa fa-check"></i><b>1.1</b> 기술통계 분석</a></li>
<li class="chapter" data-level="1.2" data-path="ch-statisics.html"><a href="ch-statisics.html#sec-inferStat"><i class="fa fa-check"></i><b>1.2</b> 추론통계 분석</a></li>
<li class="chapter" data-level="1.3" data-path="ch-statisics.html"><a href="ch-statisics.html#sec-statAnalysis"><i class="fa fa-check"></i><b>1.3</b> 통계 분석의 절차</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch-statisics.html"><a href="ch-statisics.html#문제-정의"><i class="fa fa-check"></i><b>1.3.1</b> 문제 정의</a></li>
<li class="chapter" data-level="1.3.2" data-path="ch-statisics.html"><a href="ch-statisics.html#데이터-수집"><i class="fa fa-check"></i><b>1.3.2</b> 데이터 수집</a></li>
<li class="chapter" data-level="1.3.3" data-path="ch-statisics.html"><a href="ch-statisics.html#데이터-전처리-및-탐색"><i class="fa fa-check"></i><b>1.3.3</b> 데이터 전처리 및 탐색</a></li>
<li class="chapter" data-level="1.3.4" data-path="ch-statisics.html"><a href="ch-statisics.html#통계-모형-수립"><i class="fa fa-check"></i><b>1.3.4</b> 통계 모형 수립</a></li>
<li class="chapter" data-level="1.3.5" data-path="ch-statisics.html"><a href="ch-statisics.html#결론-도출"><i class="fa fa-check"></i><b>1.3.5</b> 결론 도출</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch-statisics.html"><a href="ch-statisics.html#sec-statVariables"><i class="fa fa-check"></i><b>1.4</b> 통계 데이터에서 변수의 종류</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ch-statisics.html"><a href="ch-statisics.html#질적-변수"><i class="fa fa-check"></i><b>1.4.1</b> 질적 변수</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch-statisics.html"><a href="ch-statisics.html#양적-변수"><i class="fa fa-check"></i><b>1.4.2</b> 양적 변수</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R 기초</b></span></li>
<li class="chapter" data-level="2" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>2</b> R 설치 및 시작</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-intro.html"><a href="ch-intro.html#sec-Rintro"><i class="fa fa-check"></i><b>2.1</b> R 소개</a></li>
<li class="chapter" data-level="2.2" data-path="ch-intro.html"><a href="ch-intro.html#sec-installation"><i class="fa fa-check"></i><b>2.2</b> R 설치하기</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-intro.html"><a href="ch-intro.html#r-배포판-내려받기"><i class="fa fa-check"></i><b>2.2.1</b> R 배포판 내려받기</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-intro.html"><a href="ch-intro.html#설치에-앞서-주의할-사항"><i class="fa fa-check"></i><b>2.2.2</b> 설치에 앞서 주의할 사항</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch-intro.html"><a href="ch-intro.html#r-설치하기"><i class="fa fa-check"></i><b>2.2.3</b> R 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-intro.html"><a href="ch-intro.html#sec-RStudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch-intro.html"><a href="ch-intro.html#rstudio-설치"><i class="fa fa-check"></i><b>2.3.1</b> RStudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-intro.html"><a href="ch-intro.html#sec-R-start"><i class="fa fa-check"></i><b>2.4</b> RStudio로 R 시작하기</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔과-프롬프트"><i class="fa fa-check"></i><b>2.4.1</b> R 콘솔과 프롬프트</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔-사용과-관련된-몇-가지-팁"><i class="fa fa-check"></i><b>2.4.2</b> R 콘솔 사용과 관련된 몇 가지 팁</a></li>
<li class="chapter" data-level="2.4.3" data-path="ch-intro.html"><a href="ch-intro.html#r-스크립트-파일-만들기"><i class="fa fa-check"></i><b>2.4.3</b> R 스크립트 파일 만들기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html"><i class="fa fa-check"></i><b>3</b> R 데이터 형식과 변수</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#sec-simpleDataType"><i class="fa fa-check"></i><b>3.1</b> 단순한 데이터 형식</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#r의-기본적-데이터-형식-숫자-문자열-논리값"><i class="fa fa-check"></i><b>3.1.1</b> R의 기본적 데이터 형식: 숫자, 문자열, 논리값</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#vs-10"><i class="fa fa-check"></i><b>3.1.2</b> 10 vs “10”</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#sec-simpleOperation"><i class="fa fa-check"></i><b>3.2</b> 숫자 연산</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#사칙-연산"><i class="fa fa-check"></i><b>3.2.1</b> 사칙 연산</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#거듭-제곱-연산"><i class="fa fa-check"></i><b>3.2.2</b> 거듭 제곱 연산</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#몫과-나머지"><i class="fa fa-check"></i><b>3.2.3</b> 몫과 나머지</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#비교-연산-그리고-vs."><i class="fa fa-check"></i><b>3.2.4</b> 비교 연산 그리고 <code>==</code> vs. <code>=</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#논리값-연산"><i class="fa fa-check"></i><b>3.3</b> 논리값 연산</a></li>
<li class="chapter" data-level="3.4" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#문자열-연산"><i class="fa fa-check"></i><b>3.4</b> 문자열 연산</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#문자열-결합-연산-paste"><i class="fa fa-check"></i><b>3.4.1</b> 문자열 결합 연산: <code>paste()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#문자열-분리-연산-strsplit"><i class="fa fa-check"></i><b>3.4.2</b> 문자열 분리 연산: <code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#sec-variable"><i class="fa fa-check"></i><b>3.5</b> 변수와 할당</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수는-메모리-공간에-붙이는-레이블"><i class="fa fa-check"></i><b>3.5.1</b> 변수는 메모리 공간에 붙이는 레이블</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수명에-대한-규칙"><i class="fa fa-check"></i><b>3.5.2</b> 변수명에 대한 규칙</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수에-값-할당하기"><i class="fa fa-check"></i><b>3.5.3</b> 변수에 값 할당하기</a></li>
<li class="chapter" data-level="3.5.4" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#할당-연산자"><i class="fa fa-check"></i><b>3.5.4</b> 할당 연산자</a></li>
<li class="chapter" data-level="3.5.5" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#연산에-변수-사용하기"><i class="fa fa-check"></i><b>3.5.5</b> 연산에 변수 사용하기</a></li>
<li class="chapter" data-level="3.5.6" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수에-값-재할당하기"><i class="fa fa-check"></i><b>3.5.6</b> 변수에 값 재할당하기</a></li>
<li class="chapter" data-level="3.5.7" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#할당문은-우변이-수행된-후-좌변으로-할당이-이루어진다."><i class="fa fa-check"></i><b>3.5.7</b> 할당문은 우변이 수행된 후 좌변으로 할당이 이루어진다.</a></li>
<li class="chapter" data-level="3.5.8" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수-제거하기-rm"><i class="fa fa-check"></i><b>3.5.8</b> 변수 제거하기: <code>rm()</code></a></li>
<li class="chapter" data-level="3.5.9" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수-목록-확인하기-ls"><i class="fa fa-check"></i><b>3.5.9</b> 변수 목록 확인하기: <code>ls()</code></a></li>
<li class="chapter" data-level="3.5.10" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수를-할당하는-또-다른-방법-assign"><i class="fa fa-check"></i><b>3.5.10</b> 변수를 할당하는 또 다른 방법: <code>assign()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#sec-useFunctions"><i class="fa fa-check"></i><b>3.6</b> 함수를 이용한 연산</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#함수-호출-하기"><i class="fa fa-check"></i><b>3.6.1</b> 함수 호출 하기</a></li>
<li class="chapter" data-level="3.6.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#실수를-정수로-변환하는-함수"><i class="fa fa-check"></i><b>3.6.2</b> 실수를 정수로 변환하는 함수</a></li>
<li class="chapter" data-level="3.6.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#순열과-조합-함수"><i class="fa fa-check"></i><b>3.6.3</b> 순열과 조합 함수</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html"><i class="fa fa-check"></i><b>4</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-vectors"><i class="fa fa-check"></i><b>4.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#벡터는-동일-형식-데이터의-나열"><i class="fa fa-check"></i><b>4.1.1</b> 벡터는 동일 형식 데이터의 나열</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#벡터를-생성하는-법"><i class="fa fa-check"></i><b>4.1.2</b> 벡터를 생성하는 법</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-vectorOperation"><i class="fa fa-check"></i><b>4.1.3</b> 벡터의 연산</a></li>
<li class="chapter" data-level="4.1.4" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-vecFiltering"><i class="fa fa-check"></i><b>4.1.4</b> 벡터의 필터링/인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-matrices"><i class="fa fa-check"></i><b>4.2</b> 행렬과 배열</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#행렬과-배열은-다차원적-데이터-구조"><i class="fa fa-check"></i><b>4.2.1</b> 행렬과 배열은 다차원적 데이터 구조</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#행렬과-배열의-필요성"><i class="fa fa-check"></i><b>4.2.2</b> 행렬과 배열의 필요성</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-lists"><i class="fa fa-check"></i><b>4.3</b> 리스트</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#리스트-이해의-중요성"><i class="fa fa-check"></i><b>4.3.1</b> 리스트 이해의 중요성</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-dataFrames"><i class="fa fa-check"></i><b>4.4</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#데이터-프레임의-열변수은-벡터이다."><i class="fa fa-check"></i><b>4.4.1</b> 데이터 프레임의 열(변수)은 벡터이다.</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#데이터프레임을-행렬-형식으로-필터링"><i class="fa fa-check"></i><b>4.4.2</b> 데이터프레임을 행렬 형식으로 필터링</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#데이터-프레임의-문법과-조작"><i class="fa fa-check"></i><b>4.4.3</b> 데이터 프레임의 문법과 조작</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-visulaize.html"><a href="chap-visulaize.html"><i class="fa fa-check"></i><b>5</b> R 데이터 시각화 기초</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#ggplot2-패키지-설치하기"><i class="fa fa-check"></i><b>5.1</b> ggplot2 패키지 설치하기</a></li>
<li class="chapter" data-level="5.2" data-path="chap-visulaize.html"><a href="chap-visulaize.html#sec-getStarted-ggplot2"><i class="fa fa-check"></i><b>5.2</b> ggplot2 시작하기</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#subsec-tryGgplot"><i class="fa fa-check"></i><b>5.2.1</b> ggplot2 그래프의 기본 문법</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chap-visulaize.html"><a href="chap-visulaize.html#sec-aesMapping"><i class="fa fa-check"></i><b>5.3</b> 그래프 속성과 데이터 열 매핑하기 (aesthetic mapping)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#범주형-변수와-색상color-속성의-매핑"><i class="fa fa-check"></i><b>5.3.1</b> 범주형 변수와 색상(<code>color</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap-visulaize.html"><a href="chap-visulaize.html#범주형-변수와-모양shape-속성의-매핑"><i class="fa fa-check"></i><b>5.3.2</b> 범주형 변수와 모양(<code>shape</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap-visulaize.html"><a href="chap-visulaize.html#연속형-변수와-크기size-색상color-투명도alpha-속성의-매핑"><i class="fa fa-check"></i><b>5.3.3</b> 연속형 변수와 크기(<code>size</code>), 색상(<code>color</code>), 투명도(<code>alpha</code>) 속성의 매핑</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap-visulaize.html"><a href="chap-visulaize.html#sec-commonProblems"><i class="fa fa-check"></i><b>5.4</b> ggplot 명령문을 입력할 때 자주 발생하는 문제들</a></li>
<li class="chapter" data-level="5.5" data-path="chap-visulaize.html"><a href="chap-visulaize.html#sec-layerAndGeom"><i class="fa fa-check"></i><b>5.5</b> geom 함수와 그래프 계층</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#geom-함수에서-속성-매핑하기"><i class="fa fa-check"></i><b>5.5.1</b> geom 함수에서 속성 매핑하기</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap-visulaize.html"><a href="chap-visulaize.html#sec-facets"><i class="fa fa-check"></i><b>5.6</b> 측면(facets)으로 나누어 그리기</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#facet_wrap로-일차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.1</b> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기</a></li>
<li class="chapter" data-level="5.6.2" data-path="chap-visulaize.html"><a href="chap-visulaize.html#facet_grid로-이차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.2</b> <code>facet_grid()</code>로 이차원 측면 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap-visulaize.html"><a href="chap-visulaize.html#기타-ggplot2의-문법-요소"><i class="fa fa-check"></i><b>5.7</b> 기타 ggplot2의 문법 요소</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="chap-visulaize.html"><a href="chap-visulaize.html#labelsmodification"><i class="fa fa-check"></i><b>5.7.1</b> 그래프 레이블을 조정하기</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III R 기술통계 분석</b></span></li>
<li class="chapter" data-level="6" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html"><i class="fa fa-check"></i><b>6</b> 기술통계 분석이란?</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#기술통계-기법의-중요성"><i class="fa fa-check"></i><b>6.1</b> 기술통계 기법의 중요성</a></li>
<li class="chapter" data-level="6.2" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#기술통계-기법의-분류"><i class="fa fa-check"></i><b>6.2</b> 기술통계 기법의 분류</a></li>
<li class="chapter" data-level="6.3" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#bizstatp-패키지의-course-데이터"><i class="fa fa-check"></i><b>6.3</b> <code>bizstatp</code> 패키지의 <code>course</code> 데이터</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#bizstatp-패키지-설치-방법"><i class="fa fa-check"></i><b>6.3.1</b> <code>bizstatp</code> 패키지 설치 방법</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#course-데이터"><i class="fa fa-check"></i><b>6.3.2</b> <code>course</code> 데이터</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#데이터-전체에-대한-요약-정보-파악하기"><i class="fa fa-check"></i><b>6.4</b> 데이터 전체에 대한 요약 정보 파악하기</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#summary-함수를-이용하여-변수-별로-통계-요약하기"><i class="fa fa-check"></i><b>6.4.1</b> <code>summary()</code> 함수를 이용하여 변수 별로 통계 요약하기</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-introDescStat.html"><a href="ch-introDescStat.html#plot-함수를-이용한-변수-사이의-상관성-파악"><i class="fa fa-check"></i><b>6.4.2</b> <code>plot()</code> 함수를 이용한 변수 사이의 상관성 파악</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html"><i class="fa fa-check"></i><b>7</b> 범주형 변수에 대한 R 기술통계</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#한-범주형-변수에-대한-분포-분석"><i class="fa fa-check"></i><b>7.1</b> 한 범주형 변수에 대한 분포 분석</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#sec-freqTables"><i class="fa fa-check"></i><b>7.1.1</b> 범주형 변수 분포를 수치로 요약하기 - 빈도표 구하기</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#범주형-변수-분포를-그래프로-요약하기"><i class="fa fa-check"></i><b>7.1.2</b> 범주형 변수 분포를 그래프로 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#둘-이상의-범주형-변수의-상관성-분석"><i class="fa fa-check"></i><b>7.2</b> 둘 이상의 범주형 변수의 상관성 분석</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#범주형-변수의-상관성을-수치로-요약하기---교차표-만들기"><i class="fa fa-check"></i><b>7.2.1</b> 범주형 변수의 상관성을 수치로 요약하기 - 교차표 만들기</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#범주형-변수의-상관성을-그래프로-요약하기"><i class="fa fa-check"></i><b>7.2.2</b> 범주형 변수의 상관성을 그래프로 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#범주형-변수의-분석-사례"><i class="fa fa-check"></i><b>7.3</b> 범주형 변수의 분석 사례</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#관절염-치료-임상시험-데이터-분석"><i class="fa fa-check"></i><b>7.3.1</b> 관절염 치료 임상시험 데이터 분석</a></li>
<li class="chapter" data-level="7.3.2" data-path="ch-categoricalDescStat.html"><a href="ch-categoricalDescStat.html#subsec-BrokenMarriage"><i class="fa fa-check"></i><b>7.3.2</b> 이혼에 대한 사회조사 데이터 분석</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html"><i class="fa fa-check"></i><b>8</b> 수치형 변수에 대한 R 기술통계</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#한-수치형-변수에-대한-분포-분석"><i class="fa fa-check"></i><b>8.1</b> 한 수치형 변수에 대한 분포 분석</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#수치형-변수-분포를-수치로-요약하기"><i class="fa fa-check"></i><b>8.1.1</b> 수치형 변수 분포를 수치로 요약하기</a></li>
<li class="chapter" data-level="8.1.2" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#수치형-변수-분포를-그래프로-요약하기"><i class="fa fa-check"></i><b>8.1.2</b> 수치형 변수 분포를 그래프로 요약하기</a></li>
<li class="chapter" data-level="8.1.3" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#subsection:transformNumerice"><i class="fa fa-check"></i><b>8.1.3</b> 수치형 변수의 변환</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#둘-이상의-수치형-변수의-상관성-분석"><i class="fa fa-check"></i><b>8.2</b> 둘 이상의 수치형 변수의 상관성 분석</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#상관계수"><i class="fa fa-check"></i><b>8.2.1</b> 상관계수</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#산점도"><i class="fa fa-check"></i><b>8.2.2</b> 산점도</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#추세선-그리기"><i class="fa fa-check"></i><b>8.2.3</b> 추세선 그리기</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#ggpairs를-이용한-수치형-변수를-한-번에-분석하기"><i class="fa fa-check"></i><b>8.2.4</b> <code>ggpairs()</code>를 이용한 수치형 변수를 한 번에 분석하기</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#수치형-변수의-변환"><i class="fa fa-check"></i><b>8.2.5</b> 수치형 변수의 변환</a></li>
<li class="chapter" data-level="8.2.6" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#subsubsec-categorynum"><i class="fa fa-check"></i><b>8.2.6</b> 범주형 변수를 조건으로 수치형 변수의 상관성 탐색</a></li>
<li class="chapter" data-level="8.2.7" data-path="ch-numericDescStat.html"><a href="ch-numericDescStat.html#수치형-변수를-조건으로-두-수치형-변수의-상관성-분석"><i class="fa fa-check"></i><b>8.2.7</b> 수치형 변수를 조건으로 두 수치형 변수의 상관성 분석</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html"><i class="fa fa-check"></i><b>9</b> 범주형 변수와 수치형 변수의 관계 분석</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#범주별로-수치형-변수에-대해-통계-요약하기"><i class="fa fa-check"></i><b>9.1</b> 범주별로 수치형 변수에 대해 통계 요약하기</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#한-범주형-변수를-조건으로-수치형-변수를-통계-요약하기"><i class="fa fa-check"></i><b>9.1.1</b> 한 범주형 변수를 조건으로 수치형 변수를 통계 요약하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#여러-범주형-변수를-조건으로-수치형-변수를-통계-요약하기"><i class="fa fa-check"></i><b>9.1.2</b> 여러 범주형 변수를 조건으로 수치형 변수를 통계 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#범주별-수치-변수의-분포-그래프"><i class="fa fa-check"></i><b>9.2</b> 범주별 수치 변수의 분포 그래프</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#상자-그래프"><i class="fa fa-check"></i><b>9.2.1</b> 상자 그래프</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch-categorical-numeric.html"><a href="ch-categorical-numeric.html#범주별로-수치형-변수의-분포-모양을-비교하기"><i class="fa fa-check"></i><b>9.2.2</b> 범주별로 수치형 변수의 분포 모양을 비교하기</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV R 추론통계 분석</b></span></li>
<li class="chapter" data-level="10" data-path="ch-hypoTest.html"><a href="ch-hypoTest.html"><i class="fa fa-check"></i><b>10</b> 가설검정이란?</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-hypoTest.html"><a href="ch-hypoTest.html#가설의-설정"><i class="fa fa-check"></i><b>10.1</b> 가설의 설정</a></li>
<li class="chapter" data-level="10.2" data-path="ch-hypoTest.html"><a href="ch-hypoTest.html#검정통계량과-표본-분포"><i class="fa fa-check"></i><b>10.2</b> 검정통계량과 표본 분포</a></li>
<li class="chapter" data-level="10.3" data-path="ch-hypoTest.html"><a href="ch-hypoTest.html#기각역과-유의수준"><i class="fa fa-check"></i><b>10.3</b> 기각역과 유의수준</a></li>
<li class="chapter" data-level="10.4" data-path="ch-hypoTest.html"><a href="ch-hypoTest.html#유의확률-p-값p-value"><i class="fa fa-check"></i><b>10.4</b> 유의확률 p-값(p-value)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html"><i class="fa fa-check"></i><b>11</b> 범주형 변수에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#단일-모집단의-모비율에-대한-가설검정"><i class="fa fa-check"></i><b>11.1</b> 단일 모집단의 모비율에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#binom.test로-단일-모집단-모비율-검정하기"><i class="fa fa-check"></i><b>11.1.1</b> <code>binom.test()</code>로 단일 모집단 모비율 검정하기</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#빈도표를-입력변수로-전달하기"><i class="fa fa-check"></i><b>11.1.2</b> 빈도표를 입력변수로 전달하기</a></li>
<li class="chapter" data-level="11.1.3" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#prop.test로-단일-모집단-모비율-검정하기"><i class="fa fa-check"></i><b>11.1.3</b> <code>prop.test()</code>로 단일 모집단 모비율 검정하기</a></li>
<li class="chapter" data-level="11.1.4" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#정규분포를-이용한-비율-검정에서-연속성-수정"><i class="fa fa-check"></i><b>11.1.4</b> 정규분포를 이용한 비율 검정에서 연속성 수정</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#여러-모집단의-모비율의-차이에-대한-가설검정"><i class="fa fa-check"></i><b>11.2</b> 여러 모집단의 모비율의 차이에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#prop.test를-이용한-두-모집단의-모비율의-차이-검정"><i class="fa fa-check"></i><b>11.2.1</b> <code>prop.test()</code>를 이용한 두 모집단의 모비율의 차이 검정</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#교차표를-이용하여-여러-모집단의-모비율-차이를-검정하기"><i class="fa fa-check"></i><b>11.2.2</b> 교차표를 이용하여 여러 모집단의 모비율 차이를 검정하기</a></li>
<li class="chapter" data-level="11.2.3" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#fisher의-exact-test"><i class="fa fa-check"></i><b>11.2.3</b> Fisher의 Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#적합성-검정"><i class="fa fa-check"></i><b>11.3</b> 적합성 검정</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#빈도표를-이용한-적합성-검정"><i class="fa fa-check"></i><b>11.3.1</b> 빈도표를 이용한 적합성 검정</a></li>
<li class="chapter" data-level="11.3.2" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#몬테-카를로-시뮬레이션을-이용한-적합도-가설검정"><i class="fa fa-check"></i><b>11.3.2</b> 몬테 카를로 시뮬레이션을 이용한 적합도 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#독립성-검정"><i class="fa fa-check"></i><b>11.4</b> 독립성 검정</a></li>
<li class="chapter" data-level="11.5" data-path="ch-categoricalTest.html"><a href="ch-categoricalTest.html#범주형-변수의-가설검정에-대한-정리"><i class="fa fa-check"></i><b>11.5</b> 범주형 변수의 가설검정에 대한 정리</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-numericTest.html"><a href="ch-numericTest.html"><i class="fa fa-check"></i><b>12</b> 수치형 변수에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-numericTest.html"><a href="ch-numericTest.html#단일-모집단에서의-모평균에-대한-검정"><i class="fa fa-check"></i><b>12.1</b> 단일 모집단에서의 모평균에 대한 검정</a></li>
<li class="chapter" data-level="12.2" data-path="ch-numericTest.html"><a href="ch-numericTest.html#두-모집단에서의-모평균-차이에-대한-검정"><i class="fa fa-check"></i><b>12.2</b> 두 모집단에서의 모평균 차이에 대한 검정</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-numericTest.html"><a href="ch-numericTest.html#등분산이-가정되는-경우의-모평균-차이-검정"><i class="fa fa-check"></i><b>12.2.1</b> 등분산이 가정되는 경우의 모평균 차이 검정</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-numericTest.html"><a href="ch-numericTest.html#등분산이-가정될-수-없는-경우의-모평균의-차이-검정"><i class="fa fa-check"></i><b>12.2.2</b> 등분산이 가정될 수 없는 경우의 모평균의 차이 검정</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch-numericTest.html"><a href="ch-numericTest.html#데이터프레임에서-모평균-차이-검정"><i class="fa fa-check"></i><b>12.2.3</b> 데이터프레임에서 모평균 차이 검정</a></li>
<li class="chapter" data-level="12.2.4" data-path="ch-numericTest.html"><a href="ch-numericTest.html#짝진-표본에서의-모평균-차이에-대한-가설검정"><i class="fa fa-check"></i><b>12.2.4</b> 짝진 표본에서의 모평균 차이에 대한 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-numericTest.html"><a href="ch-numericTest.html#셋-이상의-모집단에서의-모평균-차이에-대한-검정"><i class="fa fa-check"></i><b>12.3</b> 셋 이상의 모집단에서의 모평균 차이에 대한 검정</a></li>
<li class="chapter" data-level="12.4" data-path="ch-numericTest.html"><a href="ch-numericTest.html#정규성을-따르지-않을-때의-가설검정"><i class="fa fa-check"></i><b>12.4</b> 정규성을 따르지 않을 때의 가설검정</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ch-numericTest.html"><a href="ch-numericTest.html#두-모집단의-중위수에-대한-비모수적-가설검정"><i class="fa fa-check"></i><b>12.4.1</b> 두 모집단의 중위수에 대한 비모수적 가설검정</a></li>
<li class="chapter" data-level="12.4.2" data-path="ch-numericTest.html"><a href="ch-numericTest.html#짝진표본에-대한-검정"><i class="fa fa-check"></i><b>12.4.2</b> 짝진표본에 대한 검정</a></li>
<li class="chapter" data-level="12.4.3" data-path="ch-numericTest.html"><a href="ch-numericTest.html#순열-검정"><i class="fa fa-check"></i><b>12.4.3</b> 순열 검정</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-anova.html"><a href="ch-anova.html"><i class="fa fa-check"></i><b>13</b> 분산 분석</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-anova.html"><a href="ch-anova.html#일원분류-분산-분석"><i class="fa fa-check"></i><b>13.1</b> 일원분류 분산 분석</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-anova.html"><a href="ch-anova.html#개념"><i class="fa fa-check"></i><b>13.1.1</b> 개념</a></li>
<li class="chapter" data-level="13.1.2" data-path="ch-anova.html"><a href="ch-anova.html#aov-함수"><i class="fa fa-check"></i><b>13.1.2</b> <code>aov()</code> 함수</a></li>
<li class="chapter" data-level="13.1.3" data-path="ch-anova.html"><a href="ch-anova.html#다중-비교"><i class="fa fa-check"></i><b>13.1.3</b> 다중 비교</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-anova.html"><a href="ch-anova.html#이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2</b> 이원분류 분산 분석</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-anova.html"><a href="ch-anova.html#교호작용이-없는-이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2.1</b> 교호작용이 없는 이원분류 분산 분석</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-anova.html"><a href="ch-anova.html#교호작용이-있는-이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2.2</b> 교호작용이 있는 이원분류 분산 분석</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-anova.html"><a href="ch-anova.html#공분산-분석"><i class="fa fa-check"></i><b>13.3</b> 공분산 분석</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 이용한 통계 분석 (개정판)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-anova" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> 분산 분석<a href="ch-anova.html#ch-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>앞 장에서 두 모집단의 모평균의 차이에 대한 가설검정을 하는 방법을 보았다.
만약 모집단이 세 개 이상으로 늘어나면, t-분포를 사용하여 더 이상 가설검정을 할 수 없다.
이 경우에는 Fisher에 의해 개발된 분산 분석(ANalysis Of VAriance; ANOVA) 기법을 사용하여 검정을 수행하여야 한다.</p>
<p>분산 분석은 역사적으로 실험계획과 밀접한 관계를 가지며 발전해 왔다. 특히 농업 분야의 실험과 연관되어 발전하였다.
비료에 의해 얻어지는 어떤 농작물의 산출물의 양을 측정하는 실험을 고려해 보자.
이 실험을 위해 다른 조건을 같게 한 후, A, B, C라는 서로 다른 비료를 사용하여 산출물의 양을 실험하였다고 하자.</p>
<ul>
<li>이러한 실험계획에서 비료의 종류를 요인(factors)이라고 한다.</li>
<li>서로 다른 비료 A, B, C를 수준(levels) 또는 처리(treatments)라고 한다.</li>
<li>실험의 최종 결과인 산출물의 양을 반응변수(response variables)라고 한다.</li>
<li>수준에 따라 반응변수의 평균에 차이가 나는 것을 요인의 효과(effects)라고 한다.</li>
</ul>
<p>분산 분석은 ’요인의 효과는 없다’라는 귀무가설과 ’요인의 효과가 있다’라는 대립가설에 대한 가설검정을 수행한다. 분산 분석에서 수준이 2개인 경우는 앞선 본 두 모집단의 모평균의 차이 검정으로 효과의 차이를 분석할 수 있으나, 수준이 3 개 이상이면 분산 분석을 통해 가설검정을 수행하여야 한다.</p>
<p>분산 분석은 요인이 한 개인 경우뿐 아니라 두 개인 경우에도 분석이 가능하다. 예를 들어 앞의 실험에서 비료의 효과만 보는 것이 아니라 토양의 특성에 따라 비료의 효과가 달라지는지를 보고자 한다면, 비료라는 한 요인과 토질이라는 또 다른 요인이 농작물의 산출에 주는 효과를 분석하게 된다. 요인이 하나인 분산 분석을 일원분류 분산 분석(one-way ANOVA)이라 하고, 요인이 두 개인 분산 분석을 이원분류 분산 분석(two-way ANOVA)라고 한다.</p>
<div id="일원분류-분산-분석" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> 일원분류 분산 분석<a href="ch-anova.html#일원분류-분산-분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="개념" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> 개념<a href="ch-anova.html#개념" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>수준이 <span class="math inline">\(I\)</span>개인 요인으로 실험을 한다고 하자. 예를 들어 앞의 비료라는 요인은 수준이 A, B, C이므로, <span class="math inline">\(I=3\)</span>인 요인이 된다.
각 수준을 수준 <span class="math inline">\(i\)</span>라고 할 때, 수준 <span class="math inline">\(i\)</span>에 대해 <span class="math inline">\(n_i\)</span> 번만큼 실험을 했다고 하자. 단, <span class="math inline">\(i=1, 2, \ldots, I\)</span>.<br />
그리고 <span class="math inline">\(y_{ik}\)</span>를 수준 <span class="math inline">\(i\)</span>에 대해서 <span class="math inline">\(k\)</span> 번째 실험을 했을 때의 반응변수의 값이라고 하면, 일원분류 분산 분석은 다음과 같은 모형을 가정한다.</p>
<p><span class="math display">\[
y_{ik} = \mu_i + \varepsilon_{ik} = \mu + \alpha_i + \varepsilon_{ik}
\]</span>
단, <span class="math inline">\(\mu_i\)</span>는 수준 <span class="math inline">\(i\)</span>에서의 반응변수의 평균, <span class="math inline">\(\mu\)</span>는 전체 모평균, <span class="math inline">\(\alpha_i = \mu_i - \mu\)</span>는 수준 <span class="math inline">\(i\)</span>의 효과이다. 그리고 오차항 독립이고 동일한 <span class="math inline">\(\varepsilon_{ik} \sim N(0, \sigma^2)\)</span> 분포를 따른다고 가정한다. 즉, 모든 수준에서 오차항은 평균이 0이고 분산이 같은 i.i.d. 정규분포를 따른다.</p>
<p>일원분류 분산 분석의 귀무가설은 요인의 효과가 없다는 것으로 다음과 같이 표현할 수 있다.</p>
<p><span class="math display">\[
H_0: \quad \mu_1 = \mu_2 = \cdots = \mu_I \quad
\]</span></p>
<p>또는</p>
<p><span class="math display">\[
H_0: \quad \alpha_1 = \alpha_2 = \cdots = \alpha_I = 0
\]</span></p>
<p>대립가설은 위의 등식 중 하나 이상이 성립하지 않는다는 것이다.</p>
<p>ANOVA의 가설검정은 전체 평균을 중심으로 데이터가 변동하는 이유를 요인에 의해 발생하는 분산과 무작위 오차에 의한 분산으로 분할하여 분석을 한다. (그렇기 때문에 분산 분석이라는 이름이 붙게 되었다.)
표본 데이터의 전체 평균과 각 수준의 평균을 다음처럼 정의하자.</p>
<p><span class="math display">\[\begin{align}
\bar{y} =&amp; \frac{\sum_{i=1}^{I} \sum_{k=1}^{n_i} y_{ik}}{n} \\
\bar{y}_{i.} =&amp; \frac{\sum_{k=1}^{n_i} y_{ik}}{n_i}
\end{align}\]</span></p>
<p>단, <span class="math inline">\(n = \sum_{i=1}^{I} n_i\)</span>.</p>
<p>그러면 표본의 전체 평균 <span class="math inline">\(\bar{y}\)</span>와 각 데이터의 편차의 제곱은 다음처럼 분해된다.</p>
<p><span class="math display">\[\begin{eqnarray}
\sum_{i=1}^{I} \sum_{k=1}^{n_i} (y_{ik} - \bar{y})^2
    &amp;=&amp; \sum_{i=1}^{I} (\bar{y}_{i.} - \bar{y})^2
    &amp;+&amp;  \sum_{i=1}^{I} \sum_{k=1}^{n_i} (y_{ik} - \bar{y}_{i.})^2 \\
TSS &amp;=&amp; SST &amp;+&amp; SSE
\end{eqnarray}\]</span></p>
<p>전체 평균에서 데이터의 변동을 TSS(total sum of squares)라고 하고, 전체 평균에서 수준의 평균의 변동을 SST(sum of squares for treatment), 수준의 평균에서 데이터의 변동을 SSE(sum of squares for residual)라고 한다.</p>
<p>일원분류 분산 분석에서의 검정통계량 <span class="math inline">\(F\)</span>는 다음과 같이 정의되고, <span class="math inline">\(F\)</span>는 자유도가 <span class="math inline">\((I-1)\)</span>과 <span class="math inline">\((n-I)\)</span>인 F-분포를 따른다.</p>
<p><span class="math display">\[
F = \frac{MST}{MSE} = \frac{SST / (I-1)}{ SSE / (n-I)} \sim F(I-1, n-I)
\]</span></p>
<p>귀무가설이 맞지 않으면 요인의 효과에 의해 SST가 커지므로 가설검정은 오른쪽 단측검정을 하게 된다.</p>
<p>일원분류 분산 분석의 결과는 다음과 같은 분산 분석표로 보통 요약된다.</p>
<table>
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">변동 원인</th>
<th align="center">자유도</th>
<th align="center">제곱합</th>
<th align="center">평균제곱합</th>
<th align="center">F-통계량</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">요인</td>
<td align="center"><span class="math inline">\(I-1\)</span></td>
<td align="center">SST</td>
<td align="center">MST</td>
<td align="center">F</td>
</tr>
<tr class="even">
<td align="center">오차</td>
<td align="center"><span class="math inline">\(n-I\)</span></td>
<td align="center">SSE</td>
<td align="center">MSE</td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
<div id="aov-함수" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> <code>aov()</code> 함수<a href="ch-anova.html#aov-함수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>R</strong>에서 ANOVA 분석을 수행하는 함수는 <code>aov()</code> 함수이다. 참고로 <strong>R</strong>에는 <code>anova()</code> 함수도 있는데 이 함수는 회귀 모형 등이 적합된 후 모형들 사이의 분산 분석을 수행할 때 이용된다.
<code>aov()</code> 함수는 첫번째 인수로 ANOVA 모형을 나타내는 수식을, 두번째 인수로 사용할 데이터를 입력받는다.
일원분류 분산 분석은 반응변수를 나타내는 열이 <code>y</code>, 요인을 나타내는 열이 <code>f</code>라고 하면 다음 형식으로 수식이 입력된다.</p>
<pre><code>aov(y ~ f, data)</code></pre>
<p>요인이 둘 이상인 이원분류 분산 분석이나 다른 수치형 변수의 효과를 고려하여 분산 분석을 하는 공분산 분석의 경우 수식의 표현이 좀 더 복잡해 진다. 이에 대해서는 각각의 모형을 다룰 때 설명하도록 한다.</p>
<p>이 장에서는 <strong>R</strong>에서 분산 분석을 하는 방법을 설명하기 위해 <code>bizstatp</code> 패키지의 <code>course</code> 데이터를 사용할 것이다. 그런데 <code>course</code> 데이터에서 중간과 기말고사를 보지 않은 학생 정보가 있다. 우리는 이 학생의 정보를 제거한 <code>course_omitted</code> 데이터를 만들어 앞으로 이 데이터를 주로 분석에 사용할 것이다.</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="ch-anova.html#cb1033-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(bizstatp)</span>
<span id="cb1033-2"><a href="ch-anova.html#cb1033-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> course_omitted <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(course)</span></code></pre></div>
<div class="example">
<p><span id="exm:aov-course" class="example"><strong>Example 13.1  </strong></span><code>course_omitted</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
이 과목의 최종 점수의 평균이 학년별로 차이가 있었는지에 대해 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch-anova.html#exm:aov-course">13.1</a>는 2, 3, 4 학년의 최종 점수 평균의 차이를 검정하는 문제이다. 3개 이상의 모집단의 평균을 비교해야 하므로 분산 분석을 수행해야 한다.<br />
<span class="math inline">\(\mu_i\)</span>를 <span class="math inline">\(i\)</span>-학년의 최종 점수의 평균이라고 하자.
평균 점수에 차이가 있었는지를 검정하는 것이므로 귀무가설은 다음과 같다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad \mu_2 = \mu_3 = \mu_4 \\
\end{align}
\]</span></p>
<p>위의 가설을 ANOVA로 가설검정하려면 먼저 학년별 최종 점수가 동일한 분산의 정규분포를 따르는지 확인해 보아야 한다.<br />
그런데 일반적으로 각 수준별로 정규성을 검정하는 작업은 번거롭기 때문에 ANOVA 분석을 한 후 잔차(residuals)가 동일한 분산의 정규분포를 따르는지 확인하는 것이 좋다.
현재 <code>year</code> 열은 순서형 범주로 입력되어 있다. ANOVA 분석을 위해 순서형 볌주를 다음처럼 명목형 범주로 변경을 한다.</p>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="ch-anova.html#cb1034-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> course_omitted<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">factor</span>(course_omitted<span class="sc">$</span>year, <span class="at">ordered =</span> F)</span></code></pre></div>
<p>다음은 각 학년의 최종점수가 동일한 분산의 정규분포를 따른다는 가정 하에 <code>aov()</code>을 사용하여 분산 분석을 수행한 결과이다. <code>aov()</code> 함수는 기본적으로 요인과 잔차에 대한 제곱합과 자유도만 출력한다.</p>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="ch-anova.html#cb1035-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> year, <span class="at">data =</span> course_omitted)</span>
<span id="cb1035-2"><a href="ch-anova.html#cb1035-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>Call:
   aov(formula = score ~ year, data = course_omitted)

Terms:
                    year Residuals
Sum of Squares   286.022  5552.534
Deg. of Freedom        2        41

Residual standard error: 11.63734
Estimated effects may be unbalanced</code></pre>
<p>분산 분석 결과에서 분산 분석표를 출력하려면 <code>summary()</code> 함수 또는 <code>anova()</code>를 사용하여 분산 분석 결과를 출력해 보아야 한다.</p>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="ch-anova.html#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
year         2    286   143.0   1.056  0.357
Residuals   41   5553   135.4               </code></pre>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="ch-anova.html#cb1039-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: score
          Df Sum Sq Mean Sq F value Pr(&gt;F)
year       2  286.0  143.01   1.056 0.3571
Residuals 41 5552.5  135.43               </code></pre>
<p>p-값이 0.3571148로 유의수준 0.05이므로 귀무가설을 채택한다. (대립가설을 기각한다.)
즉, 학년별 성적의 차이가 있었다는 통계적 증거는 찾지 못하였다.</p>
<p>아울러 <code>aov()</code> 함수의 결과는 여러 하위 요소를 가지고 있다. 이 요소 중 <code>coefficients</code>를 확인하면 각 수준별 평균을 확인할 수 있다.</p>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1041-1"><a href="ch-anova.html#cb1041-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)       year3       year4 
  71.447813    3.958854    8.802188 </code></pre>
<p><code>(Intercept)</code>라고 표현한 항이 <code>year</code> 열의 기준이 되는 첫번째 수준의 평균이다. 현재 2학년이 첫번째 수준으로 정의되어 있으므로 2학년의 최종점수의 평균이다.<br />
<code>year3</code>과 <code>year4</code>는 기준이 되는 2학년 평균에서 3학년과 4학년 학생의 평균의 차이를 나타낸다. 따라서 3학년과 4학년 학생의 평균은 각각 75.4066667와 80.25이다.</p>
<p>전체 평균에서 각 수준의 평균의 차이 <span class="math inline">\(\alpha_i\)</span>를 확인하려면 <code>model.tables()</code> 함수를 사용한다. 각 수준의 평균과 전체 평균의 차이와 아울러 데이터의 수가 몇개 였는지를 알려준다.</p>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1043-1"><a href="ch-anova.html#cb1043-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">model.tables</span>(result)</span></code></pre></div>
<pre><code>Tables of effects

 year 
        2     3     4
    -1.41 2.549 7.392
rep 32.00 9.000 3.000</code></pre>
<p>그런데 앞서 설명한 바와 같이 분산 분석은 각 수준에서의 오차의 분포에 대해 정규성과 등분산성을 가정한다.
이러한 가정이 성립하는지를 시각적으로 확인하는 한 방법은, <code>plot()</code> 함수를 사용하여 잔차 그래프를 그리고, 잔차에 대해 Q-Q 그림을 그려보는 것이다.</p>
<p><code>plot()</code> 함수의 첫 번째 그림은 각 수준의 평균 대비 잔차의 그래프를 보여준다. 현재 2학년의 평균이 가장 낮고 학년이 올라갈수록 평균이 커지고 있으므로, 가로축을 기준으로 2, 3, 4학년 학생의 잔차를 보여준다. 전체적으로 잔차가 0을 기준으로 대칭적으로 분포하고 있으나, 4학년의 잔차가 2, 3학년의 잔차보다 퍼진 정도가 줄어들고 있는데, 이러한 현상이 데이터가 줄어들어 발생한 우연적인 현상인지, 아니면 등분산을 가정하기 어렵다는 통계적 증거인지 가설검정해 볼 필요가 있다.</p>
<p><code>plot()</code> 함수의 두 번째 그림은 모든 수준의 잔차를 이론적인 정규분포와 대비하여 Q-Q 그림을 그린 결과이다. 전체적으로 정규분포를 잘 따르고 있지만 양 꼬리로 갈수록 이론적인 정규분포에 비해 더 중앙 쪽으로 몰리는 경향을 보인다.</p>
<p><code>plot()</code> 함수의 세 번째 그림은 수준 별로 표준화된 잔차의 절대값에 제곱근을 취한 값의 분포를 보여준다. 등분산일수록 평균선을 나타내는 빨간 선이 직선의 형태를 취한다.</p>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1045-1"><a href="ch-anova.html#cb1045-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(result)</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-9-1.png" width="50%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-9-2.png" width="50%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-9-3.png" width="50%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-9-4.png" width="50%" style="display: block; margin: auto;" /></p>
<p>잔차의 정규성을 확인하기 위해서 <code>aov()</code> 함수의 결과에서 <code>residuals</code>를 뽑아서 정규성에 대해 가설검정을 해보았다. p-값이 크게 나와서 잔차의 정규성을 기각하는 통계적 증거를 찾지 못했음을 알 수 있다.</p>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1046-1"><a href="ch-anova.html#cb1046-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">shapiro.test</span>(result<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  result$residuals
W = 0.96798, p-value = 0.2564</code></pre>
<p>등분산성을 가설검정할 때 요인의 수준이 2 개인 경우에는 두 모집단의 분산의 차이 검정을 F-분포를 사용하여 수행할 수 있다. 이 경우에는 <code>var.test()</code> 함수를 이용하여 가설검정을 수행하였다. 그러나 요인의 수준이 3 개 이상인 경우에는 <code>bartlet.test()</code>을 사용한다. 역시 p-값이 크게 나와서 등분산 가정을 배척해야 할 통계적 증거를 찾지 못했다.</p>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1048-1"><a href="ch-anova.html#cb1048-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">bartlett.test</span>(score <span class="sc">~</span> year, <span class="at">data =</span> course_omitted)</span></code></pre></div>
<pre><code>
    Bartlett test of homogeneity of variances

data:  score by year
Bartlett&#39;s K-squared = 1.2141, df = 2, p-value = 0.545</code></pre>
</div>
<div id="다중-비교" class="section level3 hasAnchor" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> 다중 비교<a href="ch-anova.html#다중-비교" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:aov-cholesterol" class="example"><strong>Example 13.2  </strong></span><code>multcomp</code> 패키지의 <code>cholesterol</code> 데이터는 50 명의 환자에게 5개의 콜레스테롤 감소 약을 처방한 후 그 효과를 측정한 데이터이다.<br />
처방에 따라 콜레스테롤 감소에 차이가 있었는지에 대해 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch-anova.html#exm:aov-cholesterol">13.2</a>를 가설검정하기 위해서는 <code>multcomp</code> 패키지에 대한 설치와 적재가 필요하다.</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="ch-anova.html#cb1050-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">install.packages</span>(<span class="st">&quot;multcomp&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1051-1"><a href="ch-anova.html#cb1051-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(multcomp)</span>
<span id="cb1051-2"><a href="ch-anova.html#cb1051-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(cholesterol)</span></code></pre></div>
<pre><code>     trt        response     
 1time :10   Min.   : 2.304  
 2times:10   1st Qu.: 8.409  
 4times:10   Median :12.605  
 drugD :10   Mean   :12.738  
 drugE :10   3rd Qu.:17.519  
             Max.   :27.244  </code></pre>
<p>실험 요인인 <code>trt</code>의 세 수준은 같은 약을 20mg씩 하루에 한 번, 10mg씩 하루에 두 번, 5mg씩 하루에 네 번 투약한 것이고, 다른 두 수준은 이 약과 경쟁하고 있는 콜레스테롤 약 D와 E를 투여한 것이다.</p>
<p>각 수준 별로 콜레스테롤 감소량(<code>response</code>)의 평균과 상자 그림을 그리면 다음과 같다</p>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="ch-anova.html#cb1053-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">aggregate</span>(response <span class="sc">~</span> trt, <span class="at">data =</span> cholesterol, mean)</span></code></pre></div>
<pre><code>     trt response
1  1time  5.78197
2 2times  9.22497
3 4times 12.37478
4  drugD 15.36117
5  drugE 20.94752</code></pre>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="ch-anova.html#cb1055-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(cholesterol, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> response)) <span class="sc">+</span> </span>
<span id="cb1055-2"><a href="ch-anova.html#cb1055-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> T)</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-15-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>결과에서 자주 투여할수록 효과가 좋았으며, 약 D와 E의 효과가 더 좋은 것을 볼 수 있다. 과연 이러한 차이가 통계적으로 차이가 있는지 확인해 보자.</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="ch-anova.html#cb1056-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">aov</span>(response <span class="sc">~</span> trt, <span class="at">data =</span> cholesterol)</span>
<span id="cb1056-2"><a href="ch-anova.html#cb1056-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: response
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
trt        4 1351.37  337.84  32.433 9.819e-13 ***
Residuals 45  468.75   10.42                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>p-값은 9.8185163^{-13}로 유의수준 0.05에서 귀무가설을 기각한다. (대립가설을 채택한다.)
즉, 약물 처리에 따라 콜레스테롤 감소에 차이가 있었다.</p>
<p>위 가설검정이 가정하고 있는 정규성과 등분산성을 확인해 보자.</p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="ch-anova.html#cb1058-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(result, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-18-1.png" width="60%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-18-2.png" width="60%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-18-3.png" width="60%" style="display: block; margin: auto;" /></p>
<p>전체적으로 모든 수준에서 잔차가 고르게 분포되어 있고 Q-Q 그림에서도 정규분포에 가깝게 나와 정규성과 등분산성을 만족할 것으로 보인다. 실제 그런지 가설검정을 해보자.
두 검정 모두에서 p-값이 크게 나와 정규성과 등분산성 가정을 기각하지 못했으므로, 앞선 ANOVA 분석의 가정이 만족된다고 판단된다.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1059-1"><a href="ch-anova.html#cb1059-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">shapiro.test</span>(result<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  result$residuals
W = 0.98864, p-value = 0.9094</code></pre>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="ch-anova.html#cb1061-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">bartlett.test</span>(response <span class="sc">~</span> trt, <span class="at">data =</span> cholesterol)</span></code></pre></div>
<pre><code>
    Bartlett test of homogeneity of variances

data:  response by trt
Bartlett&#39;s K-squared = 0.57975, df = 4, p-value = 0.9653</code></pre>
<p>그런데 ANOVA 분석을 통해 평균이 같다는 귀무가설이 기각되면, 어는 수준 간의 차이에 의해 귀무가설이 기각되었는지 살펴보아야 한다.
이를 살펴보는 방법 중 하나가 가능한 모든 두 수준 간에 평균의 차이가 있었는지를 가설검정해 보는 것이다. 이는 두 모집단 간의 모평균 비교와 같아진다.
다만 수준이 많은 경우 단순히 두 수준 간의 평균의 차이를 가설검정하는 것은 여러 개의 가설을 동시적으로 검정하는 것이 되어서 기각역 또는 p-값의 조정이 필요하다.
<strong>R</strong>의 기본 기능에 포함되어 있는 <code>TukeyHSD()</code> 함수는 이러한 수준별 쌍 비교를 수행해 준다.</p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="ch-anova.html#cb1063-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">TukeyHSD</span>(result)</span></code></pre></div>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = response ~ trt, data = cholesterol)

$trt
                  diff        lwr       upr     p adj
2times-1time   3.44300 -0.6582817  7.544282 0.1380949
4times-1time   6.59281  2.4915283 10.694092 0.0003542
drugD-1time    9.57920  5.4779183 13.680482 0.0000003
drugE-1time   15.16555 11.0642683 19.266832 0.0000000
4times-2times  3.14981 -0.9514717  7.251092 0.2050382
drugD-2times   6.13620  2.0349183 10.237482 0.0009611
drugE-2times  11.72255  7.6212683 15.823832 0.0000000
drugD-4times   2.98639 -1.1148917  7.087672 0.2512446
drugE-4times   8.57274  4.4714583 12.674022 0.0000037
drugE-drugD    5.58635  1.4850683  9.687632 0.0030633</code></pre>
<p>위의 결과에서 유의수준 0.05에서 평균에 차이가 없었던 수준의 쌍은 2times-1time, 4times-2times, drugD-4times였다. 그 외에는 두 수준 간에 통계적으로 유의미한 차이가 발생하였다.
<code>plot()</code> 함수를 이용하면 다중 비교에 대한 95% 신뢰구간을 그려볼 수 있다. 신뢰구간이 0을 포함하고 있는 비교 쌍은 유의수준 5%에서 차이가 유의미하지 않은 수준 쌍을 의미한다. 0에서 멀리 떨어져서 신뢰구간이 생성된 쌍은 두 처리 간에 효과의 차이가 매우 큰 쌍을 의미한다.</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="ch-anova.html#cb1065-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(<span class="at">las=</span><span class="dv">2</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb1065-2"><a href="ch-anova.html#cb1065-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(result))</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-22-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>만약 첫번째 수준과 그 외의 다른 수준과의 차이를 비교하고 싶으면 Dunnett 방법을 사용하여 다중 비교를 하면 된다. Dunnett 방식으로 다중 비교를 하려면 일반적인 선형 가설검정을 해주는 함수인 <code>glht()</code> 함수를 사용하여 <code>linfct = mcp(요인 = "Dunnett")</code>으로 다중 비교를 수행한다. 결과에서 1times는 2times를 제외한 다른 모든 수준과 평균에서 유의미한 차이가 발생하였음을 확인할 수 있다.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1066-1"><a href="ch-anova.html#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> dunnett <span class="ot">&lt;-</span> <span class="fu">glht</span>(result, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">trt =</span> <span class="st">&quot;Dunnett&quot;</span>))</span>
<span id="cb1066-2"><a href="ch-anova.html#cb1066-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(dunnett)</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = response ~ trt, data = cholesterol)

Linear Hypotheses:
                    Estimate Std. Error t value Pr(&gt;|t|)    
2times - 1time == 0    3.443      1.443   2.385   0.0697 .  
4times - 1time == 0    6.593      1.443   4.568   &lt;0.001 ***
drugD - 1time == 0     9.579      1.443   6.637   &lt;0.001 ***
drugE - 1time == 0    15.166      1.443  10.507   &lt;0.001 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<div id="이원분류-분산-분석" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> 이원분류 분산 분석<a href="ch-anova.html#이원분류-분산-분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>반응변수에 영향을 미치는 요인이 두 개인 경우에는 이원분류 분산 분석을 한다. 요인이 세 개 이상인 경우에도 분산 분석을 수행할 수 있다. 그러나 분석해야 할 요인들이 많아지면 선형회귀모형으로 분석하는 것이 더 간편하다.</p>
<div id="교호작용이-없는-이원분류-분산-분석" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> 교호작용이 없는 이원분류 분산 분석<a href="ch-anova.html#교호작용이-없는-이원분류-분산-분석" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>R</strong>에서 이원분류 분산 분석은 일원분류 분산 분석과 마찬가지로 <code>aov()</code> 함수를 사용한다. 다만 수식의 오른편에 요인을 <code>+</code> 연산자로 연결하여 표현한다. 이 때 요인이 기술되는 순서가 매우 중요하다.</p>
<pre><code>aov(y ~ A + B)
aov(y ~ B + A)</code></pre>
<p>위의 수식 표현에서 두 요인이 결합된 모든 수준에서 관측 수가 동일하면 수식에 기술되는 요인의 순서는 중요하지 않다. 그러나 관측 수가 수준 별로 서로 다른 경우에는 어떤 요인을 먼저 기술하였는지가 중요하다. <strong>R</strong>에서는 ANOVA 분석을 할 때 먼저 기술된 요인의 반응변수에 미치는 효과가 제거되었을 때, 뒤에 나오는 변수가 반응변수에 미치는 효과가 있는지를 가설검정한다. 수준 별 관측 수가 동일한 경우에는 각 요인의 효과가 독립적으로 분할되므로 순서가 중요하지 않지만 그렇지 않은 경우에는 기술 순서에 주의하여야 한다. 일반적으로 가설 검정을 통해 증명하고자 하는 변수가 뒤에 기술된다. 그리고 통제 변수에 해당되는 변수가 앞에 기술된다. 예를 들어 두 약의 효과를 비교할 때 성별 차이가 발생할 수 있다. 성별 차이를 제외하고 두 약만의 효과를 보고자 한다면, 성별 변수를 통제 요인으로 먼저 기술하고 약의 종류를 두 번째 요인으로 기술한다.</p>
<p>다음의 예를 가지고 이원분류 분산 분석에 대하여 설명해 보자.</p>
<div class="example">
<p><span id="exm:aov-toothgrowth" class="example"><strong>Example 13.3  </strong></span><code>ToothGrowth</code> 데이터는 60 마리의 쥐에게 비타민 C 추출물과 오렌지 주스의 형태로 비타민 C를 투여하여 이빨의 성장을 측정한 데이터이다. 투여량(dose)에 따른 효과를 제외하였을 때 비타민 C의 투여 방식(supp)에 따른 이빨의 성장에 차이가 있었는지에 대해 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>먼저 <code>ToothGrowth</code> 데이터를 요약해 보자. 그리고 투여 방식과 처방량에 따른 이빨 성장의 평균과 데이터 개수를 확인해 보고 상자 그림으로 분포도 확인해 보자. 상자 그림을 그릴 때 투여량(dose)가 수치 변수이기 때문에 범주형 변수로 바꾸기 위해 <code>factor()</code> 함수를 사용하여 요인으로 변경하였다.</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="ch-anova.html#cb1069-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(ToothGrowth)</span></code></pre></div>
<pre><code>      len        supp         dose      
 Min.   : 4.20   OJ:30   Min.   :0.500  
 1st Qu.:13.07   VC:30   1st Qu.:0.500  
 Median :19.25           Median :1.000  
 Mean   :18.81           Mean   :1.167  
 3rd Qu.:25.27           3rd Qu.:2.000  
 Max.   :33.90           Max.   :2.000  </code></pre>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="ch-anova.html#cb1071-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">aggregate</span>(len <span class="sc">~</span> supp <span class="sc">+</span> dose, <span class="at">data =</span> ToothGrowth, </span>
<span id="cb1071-2"><a href="ch-anova.html#cb1071-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">n =</span> <span class="fu">length</span>(x), <span class="at">mean =</span> <span class="fu">mean</span>(x))</span>
<span id="cb1071-3"><a href="ch-anova.html#cb1071-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           )</span></code></pre></div>
<pre><code>  supp dose len.n len.mean
1   OJ  0.5 10.00    13.23
2   VC  0.5 10.00     7.98
3   OJ  1.0 10.00    22.70
4   VC  1.0 10.00    16.77
5   OJ  2.0 10.00    26.06
6   VC  2.0 10.00    26.14</code></pre>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="ch-anova.html#cb1073-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len, <span class="at">fill =</span> supp)) <span class="sc">+</span> </span>
<span id="cb1073-2"><a href="ch-anova.html#cb1073-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-26-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>투여 방식과 투여량을 각각 독립적으로 일원분류 분산 분석을 해 보자. 일원분류 분산 분석으로 각 요인의 효과를 분석해 보면, 유의 수준 5% 하에 투여 방식에 따른 이빨 성장의 차이는 보이지 않았고, 투여량은 이빨 성장의 차이를 만들어 내는 효과가 있는 것으로 판단된다.</p>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="ch-anova.html#cb1074-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result_supp <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb1074-2"><a href="ch-anova.html#cb1074-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result_supp)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: len
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
supp       1  205.4  205.35  3.6683 0.06039 .
Residuals 58 3246.9   55.98                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="ch-anova.html#cb1076-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result_dose <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> ToothGrowth)</span>
<span id="cb1076-2"><a href="ch-anova.html#cb1076-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result_dose)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: len
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
factor(dose)  2 2426.4  1213.2  67.416 9.533e-16 ***
Residuals    57 1025.8    18.0                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>그러나 이원분류 분산 분석을 해 보면 투여량의 효과와 투여량의 차이를 통제하였을 때의 투여 방식의 효과 모두 유의미한 것으로 나타난다. 일원분류 분산 분석과 이원분류 분산 분석에서 왜 이러한 차이가 났을까? 앞의 상자 그래프에서 보듯이 투여량에 따른 효과가 투여 방식의 효과를 압도하고 있기 때문에 투여량 요인을 모형에 도입하지 않으면 투여량의 효과가 모두 잔차 효과로 나타난다. 따라서 투여 방식만을 가지고 일원분류 분산 분석을 하면 투여량의 효과가 모두 랜덤한 효과로 간주되어 투여 방식의 효과가 랜덤한 효과가 아니라고 보기 어려워진다.</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="ch-anova.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result_both <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose) <span class="sc">+</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb1078-2"><a href="ch-anova.html#cb1078-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result_both)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: len
             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
factor(dose)  2 2426.43 1213.22  82.811 &lt; 2.2e-16 ***
supp          1  205.35  205.35  14.017 0.0004293 ***
Residuals    56  820.43   14.65                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>앞의 예에서 보듯이 어떤 요인의 효과를 분석할 때, 영향력이 강한 다른 요인을 모형에서 제외하고 분석을 하면 잘못된 결론에 도달 할 수 있다.
ToothGrowth 데이터는 각 수준의 조합별로 관측치의 수가 같으므로 사실 다음처럼 두 요인의 순서를 바꾸어도 동일한 결과가 나옴을 볼 수 있다. 그러나 관측치의 수가 다르면 동일한 결과가 나오지 않으므로 주의하여야 한다.</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="ch-anova.html#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(<span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">+</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> ToothGrowth))</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: len
             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
supp          1  205.35  205.35  14.017 0.0004293 ***
factor(dose)  2 2426.43 1213.22  82.811 &lt; 2.2e-16 ***
Residuals    56  820.43   14.65                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="교호작용이-있는-이원분류-분산-분석" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> 교호작용이 있는 이원분류 분산 분석<a href="ch-anova.html#교호작용이-있는-이원분류-분산-분석" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>많은 경우 두 요인의 효과가 서로 독립적이지 않고 교호 작용(interaction effects)이 있는 경우가 많다. 예를 들어 어떤 두 약 M와 N가 있을 때, 남자인 경우에는 M 약이 더 효과가 있고 여자인 경우에는 N 약이 더 효과가 있을 수 있다. 이러한 예는 성별 요인과 약의 종류라는 요인이 서로 교호 작용이 있는 경우이다.<br />
두 요인의 교효작용이 있다는 것은 두 요인의 반응변수에 대한 효과가 서로 독립이 아니라는 것을 의미한다. 만약 교호작용이 없다고 한다면 두 요인의 반응변수에 대한 효과가 서로 독립적으로 작용한다는 것을 의미한다.</p>
<p><strong>R</strong>에서 교호 작용을 분석하려면 <code>aov()</code> 함수의 수식에 교호 작용 항을 기술하면 된다. 요인이 <code>A</code>와 <code>B</code>라면 교호작용 항은 <code>A:B</code>로 표현한다. 일반적으로 두 요인의 개별적인 효과를 제외하고 남은 차이에서 교호작용을 분석하기 때문에 교호작용 항을 수식에서 맨 나중에 기술한다. <strong>R</strong>의 수식에서 두 변수와 두 변수의 교호작용을 모두 기술할 때는 <code>A*B</code> 형식으로 기술할 수 있다. 이 경우에도 순서가 중요한데 먼저 기술된 변수의 효과가 먼저 분석되고, 그 변수가 통제된 후 뒤에 나오는 변수의 효과가 분석되고, 마지막으로 두 변수의 교호작용 항의 효과가 분석된다.</p>
<pre><code>aov(y ~ A + B + A:B)
aov(y ~ A*B)</code></pre>
<div class="example">
<p><span id="exm:aov-toothgrowth2" class="example"><strong>Example 13.4  </strong></span><code>ToothGrowth</code> 데이터는 60 마리의 쥐에게 비타민 C 추출물과 오렌지 주스의 형태로 비타민 C를 투여하여 이빨의 성장을 측정한 데이터이다. 투여량(dose)과 비타민 C의 투여 방식(supp)에 따른 이빨의 성장의 차이를 통제하였을 때, 투여량과 투여 방식의 교호작용 효과가 있었는지에 대해 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch-anova.html#exm:aov-toothgrowth2">13.4</a>의 교호작용에 대한 가설검정은 다음과 같이 수행한다.</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="ch-anova.html#cb1083-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result_int <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> <span class="fu">factor</span>(dose) <span class="sc">*</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb1083-2"><a href="ch-anova.html#cb1083-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result_int)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: len
                  Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
factor(dose)       2 2426.43 1213.22  92.000 &lt; 2.2e-16 ***
supp               1  205.35  205.35  15.572 0.0002312 ***
factor(dose):supp  2  108.32   54.16   4.107 0.0218603 *  
Residuals         54  712.11   13.19                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>ANOVA 분석 결과 유의수준 5% 하에서 교호작용의 유의미한 효과가 있었다.
교호작용 요소 중에 어떤 요소가 주로 효과가 있었는지를 확인하려면 <code>interaction.plot</code> 함수를 사용하여 두 요인의 교호작용을 시각화해 볼 수 있다. <code>interaction.plot</code>의 첫 번째 인수는 가로축에 표시될 요인 변수가, 두 번째 인수는 교호작용에 참여하는 다른 요인 변수가, 세 번째 인수는 반응변수가 정의된다.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="ch-anova.html#cb1085-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">with</span>(ToothGrowth, <span class="fu">interaction.plot</span>(<span class="fu">factor</span>(dose), supp, len))</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-31-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>교효작용 도표는 교호작용이 없다면 첫 번째 요인의 수준 별로 두 번째 요인의 효과의 차이가 유지된다. 만약 선분에서 차이가 유지되지 않거나 교차한다면 교호작용이 있는 것이다. 다음 교호작용 그림은 VC와 OJ라는 <code>supp</code>에 따른 효과가 <code>dose</code>에 따라 다르게 나타남을 보여준다.
투여량이 작을수록 비타민 C 추출물보다는 오렌지 주스를 사용하여 투여하는 방법이 이빨의 성장에 더 효과적이었음을 볼 수 있다. 그러나 투여량이 2가 되면 두 방법의 차이는 거의 없었음을 볼 수 있다.</p>
<p>마지막으로 ANOVA 분석의 정규성과 등분산성을 만족하는지 검토해 보자. 등분산 검정을 위해 R의 기본 <code>interaction()</code> 함수를 사용하여 <code>supp</code>와 <code>dose</code>를 합친 요인을 새로 만들었다. <code>bartlett.test()</code>는 오직 한 요인에 대해서만 등분산을 검정하므로 두 요인을 합친 새로운 요인으로 등분산성을 검정한다.</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="ch-anova.html#cb1086-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(result_int, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-32-1.png" width="60%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-32-2.png" width="60%" style="display: block; margin: auto;" /><img src="hypothesisTest-anova_files/figure-html/unnamed-chunk-32-3.png" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="ch-anova.html#cb1087-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">shapiro.test</span>(result_int<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  result_int$residuals
W = 0.98499, p-value = 0.6694</code></pre>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1089-1"><a href="ch-anova.html#cb1089-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">bartlett.test</span>(len <span class="sc">~</span> <span class="fu">interaction</span>(supp, dose), <span class="at">data =</span> ToothGrowth)</span></code></pre></div>
<pre><code>
    Bartlett test of homogeneity of variances

data:  len by interaction(supp, dose)
Bartlett&#39;s K-squared = 6.9273, df = 5, p-value = 0.2261</code></pre>
</div>
</div>
<div id="공분산-분석" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> 공분산 분석<a href="ch-anova.html#공분산-분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>분산 분석을 할 때 반응변수에 크게 영향을 주는 수치형 변수가 있을 수 있다. 이 경우 수치형 변수의 효과를 통제한 후 요인에 대한 분산 분석을 수행하는 것이 좋다.
이런 식으로 수치형 변수의 효과를 제외하고 요인의 효과를 분석하는 방법을 공분산 분석(ANalysis of COVAriance; ANCOVA)라고 한다. 그리고 분석에 들어가는 수치형 변수를 공변인(covariate)라고 부른다.</p>
<p><strong>R</strong>에서 공분산 분석을 하는 방법은 <code>aov()</code> 함수의 수식의 우변항에 수치형 변수를 넣어주면 된다. 이 때 주의할 것은 공변인을 요인보다 먼저 수식에 기술해야 한다는 것이다. 그래야 공변인의 효과가 제외하였을 때의 요인의 반응변수에 대한 효과를 검정할 수 있다.</p>
<div class="example">
<p><span id="exm:ancova-diamonds" class="example"><strong>Example 13.5  </strong></span><code>ggplot2</code> 패키지의 <code>diamonds</code> 데이터에서 로그 변환한 다이아몬드 가격(price)에 대한 다이아몬드 투명도(clarity)의 효과를 검정하려고 한다. 로그 변환된 다이아몬드 중량(carat)의 효과를 제외했을 때, 다이아몬드 투명도가 다이아몬드 로그 가격에 영향을 미치는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p><a href="ch-numericDescStat.html#subsubsec-categorynum">8.2.6</a> 절에서 다이아몬드의 가격이 중량에 영향을 많이 받기 때문에 투명도의 효과를 정확하게 확인하기 어려웠다. 공분산 분석을 하면 수치형 변수의 영향력을 제외하고 범주형 변수의 효과를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="ch-anova.html#cb1091-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1091-2"><a href="ch-anova.html#cb1091-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> diamonds_sample <span class="ot">&lt;-</span> <span class="fu">sample_frac</span>(diamonds, <span class="at">size =</span> <span class="fl">0.05</span>)</span>
<span id="cb1091-3"><a href="ch-anova.html#cb1091-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">log</span>(carat) <span class="sc">+</span> clarity, <span class="at">data =</span> diamonds_sample)</span>
<span id="cb1091-4"><a href="ch-anova.html#cb1091-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: log(price)
             Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
log(carat)    1 2622.67 2622.67 77756.29 &lt; 2.2e-16 ***
clarity       7   83.37   11.91   353.11 &lt; 2.2e-16 ***
Residuals  2688   90.66    0.03                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>만약 중량과 투명도의 교호작용의 효과도 같이 보기를 원하면 다음처럼 분석하면 된다.</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1093-1"><a href="ch-anova.html#cb1093-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">log</span>(carat) <span class="sc">*</span> clarity, <span class="at">data =</span> diamonds_sample)</span>
<span id="cb1093-2"><a href="ch-anova.html#cb1093-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: log(price)
                     Df  Sum Sq Mean Sq    F value  Pr(&gt;F)    
log(carat)            1 2622.67 2622.67 78194.5897 &lt; 2e-16 ***
clarity               7   83.37   11.91   355.0997 &lt; 2e-16 ***
log(carat):clarity    7    0.74    0.11     3.1646 0.00246 ** 
Residuals          2681   89.92    0.03                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>그리고 다음처럼 중량과 투명도 효과를 제외했을 때 다이아몬드의 가공품질(cut)의 가격 결정 효과가 있는지도 가설검정할 수 있다.</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1095-1"><a href="ch-anova.html#cb1095-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">log</span>(carat) <span class="sc">+</span> clarity <span class="sc">+</span> cut, <span class="at">data =</span> diamonds_sample)</span>
<span id="cb1095-2"><a href="ch-anova.html#cb1095-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: log(price)
             Df  Sum Sq Mean Sq   F value    Pr(&gt;F)    
log(carat)    1 2622.67 2622.67 79452.447 &lt; 2.2e-16 ***
clarity       7   83.37   11.91   360.812 &lt; 2.2e-16 ***
cut           4    2.07    0.52    15.659 1.135e-12 ***
Residuals  2684   88.60    0.03                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>마지막으로 분산 분석과 공분산 분석 모두 선형회귀 모형을 사용하여 분석될 수 있다.</p>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="ch-anova.html#cb1097-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(price)  <span class="sc">~</span> <span class="fu">log</span>(carat) <span class="sc">*</span> clarity, <span class="at">data =</span> diamonds_sample)</span>
<span id="cb1097-2"><a href="ch-anova.html#cb1097-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(result)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: log(price)
                     Df  Sum Sq Mean Sq    F value  Pr(&gt;F)    
log(carat)            1 2622.67 2622.67 78194.5897 &lt; 2e-16 ***
clarity               7   83.37   11.91   355.0997 &lt; 2e-16 ***
log(carat):clarity    7    0.74    0.11     3.1646 0.00246 ** 
Residuals          2681   89.92    0.03                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!-- ## 비모수적 등분산성 분석* -->
<!-- 정규성과 등분산성을 만족하면 ANOVA 분석으로 반응변수에 대한 요인의 효과를 가설검정할 수 있다. 만약 반응변수가 정규성을 만족하지 않으면 어떻게 하여야 할까? 반응변수가 정규분포를 따르지 않으면, Laven 검정이나 Fligner-Killeen 검정을 사용하여 요인의 효과를 가설검정할 수 있다.  -->
<!-- `car` 패키지의 `lavenTest()` 함수는 모집단 별로 편차 점수(deviation scores)에 대한 일원분류 분산 분석을 수행한다. 기본 설정은 중위수를 중심으로 편차 점수의 동일성을 검정하나, `center = mean`으로 설정하면 평균을 중심으로 편차 점수의 동일성을 검정한다.  -->
<!-- ```{r} -->
<!-- library(car) -->
<!-- leveneTest(len ~ supp, data = ToothGrowth) -->
<!-- leveneTest(len ~ supp, data = ToothGrowth, center = mean) -->
<!-- ``` -->
<!-- **R**의 기본 `stat` 패키지의 `fligner.test()` 함수는 중위수를 중심으로 등분산성에 대한 비모수적 가설검정을 해준다. Laven 검정은 표본 크기가 커지면 작은 차이를 유의미하게 판단하는 경향이 있어서 표본이 큰 경우 `fligner.test()`도 같이 수행해 보는 것이 좋다.  -->
<!-- ```{r} -->
<!-- fligner.test(len ~ supp, data = ToothGrowth) -->
<!-- ``` -->

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Chapman, Chris, and Elea McDonnell Feit. 2015. <em><span>R</span> for Marketing Research and Analytics</em>. 2nd ed. Springer.
</div>
<div class="csl-entry">
Reshef, David N, Yakir A Reshef, Hilary K Finucane, Sharon R Grossman, Gilean McVean, Peter J Turnbaugh, Eric S Lander, Michael Mitzenmacher, and Pardis C Sabeti. 2011. <span>“Detecting Novel Associations in Large Data Sets.”</span> <em>Science</em> 334 (6062): 1518–24.
</div>
</div>
</div>
</div>













            </section>

          </div>
        </div>
      </div>
<a href="ch-numericTest.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bizStatistics.pdf", "bizStatistics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
