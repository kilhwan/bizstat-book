<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 범주형 변수에 대한 가설검정 | R을 이용한 통계 분석 (개정판)</title>
  <meta name="description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 범주형 변수에 대한 가설검정 | R을 이용한 통계 분석 (개정판)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 범주형 변수에 대한 가설검정 | R을 이용한 통계 분석 (개정판)" />
  
  <meta name="twitter:description" content="경영통계분석실습의 교재를 위해 제작되었습니다." />
  

<meta name="author" content="김길환" />


<meta name="date" content="2023-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch:hypoTest.html"/>
<link rel="next" href="ch:numericTest.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BTR0YQD3G1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTR0YQD3G1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R을 이용한 통계 분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>일러두기</a></li>
<li class="part"><span><b>I 개요</b></span></li>
<li class="chapter" data-level="1" data-path="ch:statisics.html"><a href="ch:statisics.html"><i class="fa fa-check"></i><b>1</b> 통계 분석이란?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch:statisics.html"><a href="ch:statisics.html#sec:descStat"><i class="fa fa-check"></i><b>1.1</b> 기술통계 분석</a></li>
<li class="chapter" data-level="1.2" data-path="ch:statisics.html"><a href="ch:statisics.html#sec:inferStat"><i class="fa fa-check"></i><b>1.2</b> 추론통계 분석</a></li>
<li class="chapter" data-level="1.3" data-path="ch:statisics.html"><a href="ch:statisics.html#sec:statAnalysis"><i class="fa fa-check"></i><b>1.3</b> 통계 분석의 절차</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch:statisics.html"><a href="ch:statisics.html#문제-정의"><i class="fa fa-check"></i><b>1.3.1</b> 문제 정의</a></li>
<li class="chapter" data-level="1.3.2" data-path="ch:statisics.html"><a href="ch:statisics.html#데이터-수집"><i class="fa fa-check"></i><b>1.3.2</b> 데이터 수집</a></li>
<li class="chapter" data-level="1.3.3" data-path="ch:statisics.html"><a href="ch:statisics.html#데이터-전처리-및-탐색"><i class="fa fa-check"></i><b>1.3.3</b> 데이터 전처리 및 탐색</a></li>
<li class="chapter" data-level="1.3.4" data-path="ch:statisics.html"><a href="ch:statisics.html#통계-모형-수립"><i class="fa fa-check"></i><b>1.3.4</b> 통계 모형 수립</a></li>
<li class="chapter" data-level="1.3.5" data-path="ch:statisics.html"><a href="ch:statisics.html#결론-도출"><i class="fa fa-check"></i><b>1.3.5</b> 결론 도출</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch:statisics.html"><a href="ch:statisics.html#sec:statVariables"><i class="fa fa-check"></i><b>1.4</b> 통계 데이터에서 변수의 종류</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ch:statisics.html"><a href="ch:statisics.html#질적-변수"><i class="fa fa-check"></i><b>1.4.1</b> 질적 변수</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch:statisics.html"><a href="ch:statisics.html#양적-변수"><i class="fa fa-check"></i><b>1.4.2</b> 양적 변수</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R 기초</b></span></li>
<li class="chapter" data-level="2" data-path="ch:intro.html"><a href="ch:intro.html"><i class="fa fa-check"></i><b>2</b> R 설치 및 시작</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch:intro.html"><a href="ch:intro.html#sec:Rintro"><i class="fa fa-check"></i><b>2.1</b> R 소개</a></li>
<li class="chapter" data-level="2.2" data-path="ch:intro.html"><a href="ch:intro.html#sec:installation"><i class="fa fa-check"></i><b>2.2</b> R 설치하기</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch:intro.html"><a href="ch:intro.html#r-배포판-내려받기"><i class="fa fa-check"></i><b>2.2.1</b> R 배포판 내려받기</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch:intro.html"><a href="ch:intro.html#설치에-앞서-주의할-사항"><i class="fa fa-check"></i><b>2.2.2</b> 설치에 앞서 주의할 사항</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch:intro.html"><a href="ch:intro.html#r-설치하기"><i class="fa fa-check"></i><b>2.2.3</b> R 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch:intro.html"><a href="ch:intro.html#sec:RStudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch:intro.html"><a href="ch:intro.html#rstudio-설치"><i class="fa fa-check"></i><b>2.3.1</b> RStudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch:intro.html"><a href="ch:intro.html#sec:R_start"><i class="fa fa-check"></i><b>2.4</b> RStudio로 R 시작하기</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch:intro.html"><a href="ch:intro.html#r-콘솔과-프롬프트"><i class="fa fa-check"></i><b>2.4.1</b> R 콘솔과 프롬프트</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch:intro.html"><a href="ch:intro.html#r-콘솔-사용과-관련된-몇-가지-팁"><i class="fa fa-check"></i><b>2.4.2</b> R 콘솔 사용과 관련된 몇 가지 팁</a></li>
<li class="chapter" data-level="2.4.3" data-path="ch:intro.html"><a href="ch:intro.html#r-스크립트-파일-만들기"><i class="fa fa-check"></i><b>2.4.3</b> R 스크립트 파일 만들기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html"><i class="fa fa-check"></i><b>3</b> R 데이터 형식과 변수</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#sec:simpleDataType"><i class="fa fa-check"></i><b>3.1</b> 단순한 데이터 형식</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#r의-기본적-데이터-형식-숫자-문자열-논리값"><i class="fa fa-check"></i><b>3.1.1</b> R의 기본적 데이터 형식: 숫자, 문자열, 논리값</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#vs-10"><i class="fa fa-check"></i><b>3.1.2</b> 10 vs “10”</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#sec:simpleOperation"><i class="fa fa-check"></i><b>3.2</b> 숫자 연산</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#사칙-연산"><i class="fa fa-check"></i><b>3.2.1</b> 사칙 연산</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#거듭-제곱-연산"><i class="fa fa-check"></i><b>3.2.2</b> 거듭 제곱 연산</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#몫과-나머지"><i class="fa fa-check"></i><b>3.2.3</b> 몫과 나머지</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#비교-연산-그리고-vs."><i class="fa fa-check"></i><b>3.2.4</b> 비교 연산 그리고 <code>==</code> vs. <code>=</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#논리값-연산"><i class="fa fa-check"></i><b>3.3</b> 논리값 연산</a></li>
<li class="chapter" data-level="3.4" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#문자열-연산"><i class="fa fa-check"></i><b>3.4</b> 문자열 연산</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#문자열-결합-연산-paste"><i class="fa fa-check"></i><b>3.4.1</b> 문자열 결합 연산: <code>paste()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#문자열-분리-연산-strsplit"><i class="fa fa-check"></i><b>3.4.2</b> 문자열 분리 연산: <code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#sec:variable"><i class="fa fa-check"></i><b>3.5</b> 변수와 할당</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수는-메모리-공간에-붙이는-레이블"><i class="fa fa-check"></i><b>3.5.1</b> 변수는 메모리 공간에 붙이는 레이블</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수명에-대한-규칙"><i class="fa fa-check"></i><b>3.5.2</b> 변수명에 대한 규칙</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수에-값-할당하기"><i class="fa fa-check"></i><b>3.5.3</b> 변수에 값 할당하기</a></li>
<li class="chapter" data-level="3.5.4" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#할당-연산자"><i class="fa fa-check"></i><b>3.5.4</b> 할당 연산자</a></li>
<li class="chapter" data-level="3.5.5" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#연산에-변수-사용하기"><i class="fa fa-check"></i><b>3.5.5</b> 연산에 변수 사용하기</a></li>
<li class="chapter" data-level="3.5.6" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수에-값-재할당하기"><i class="fa fa-check"></i><b>3.5.6</b> 변수에 값 재할당하기</a></li>
<li class="chapter" data-level="3.5.7" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#할당문은-우변이-수행된-후-좌변으로-할당이-이루어진다."><i class="fa fa-check"></i><b>3.5.7</b> 할당문은 우변이 수행된 후 좌변으로 할당이 이루어진다.</a></li>
<li class="chapter" data-level="3.5.8" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수-제거하기-rm"><i class="fa fa-check"></i><b>3.5.8</b> 변수 제거하기: <code>rm()</code></a></li>
<li class="chapter" data-level="3.5.9" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수-목록-확인하기-ls"><i class="fa fa-check"></i><b>3.5.9</b> 변수 목록 확인하기: <code>ls()</code></a></li>
<li class="chapter" data-level="3.5.10" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#변수를-할당하는-또-다른-방법-assign"><i class="fa fa-check"></i><b>3.5.10</b> 변수를 할당하는 또 다른 방법: <code>assign()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#sec:useFunctions"><i class="fa fa-check"></i><b>3.6</b> 함수를 이용한 연산</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#함수-호출-하기"><i class="fa fa-check"></i><b>3.6.1</b> 함수 호출 하기</a></li>
<li class="chapter" data-level="3.6.2" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#실수를-정수로-변환하는-함수"><i class="fa fa-check"></i><b>3.6.2</b> 실수를 정수로 변환하는 함수</a></li>
<li class="chapter" data-level="3.6.3" data-path="ch:R_Data_Basic.html"><a href="ch:R_Data_Basic.html#순열과-조합-함수"><i class="fa fa-check"></i><b>3.6.3</b> 순열과 조합 함수</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html"><i class="fa fa-check"></i><b>4</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:vectors"><i class="fa fa-check"></i><b>4.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#벡터는-동일-형식-데이터의-나열"><i class="fa fa-check"></i><b>4.1.1</b> 벡터는 동일 형식 데이터의 나열</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#벡터를-생성하는-법"><i class="fa fa-check"></i><b>4.1.2</b> 벡터를 생성하는 법</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:vectorOperation"><i class="fa fa-check"></i><b>4.1.3</b> 벡터의 연산</a></li>
<li class="chapter" data-level="4.1.4" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:vecFiltering"><i class="fa fa-check"></i><b>4.1.4</b> 벡터의 필터링/인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:matrices"><i class="fa fa-check"></i><b>4.2</b> 행렬과 배열</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#행렬과-배열은-다차원적-데이터-구조"><i class="fa fa-check"></i><b>4.2.1</b> 행렬과 배열은 다차원적 데이터 구조</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#행렬과-배열의-필요성"><i class="fa fa-check"></i><b>4.2.2</b> 행렬과 배열의 필요성</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:lists"><i class="fa fa-check"></i><b>4.3</b> 리스트</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#리스트-이해의-중요성"><i class="fa fa-check"></i><b>4.3.1</b> 리스트 이해의 중요성</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#sec:dataFrames"><i class="fa fa-check"></i><b>4.4</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#데이터-프레임의-열변수은-벡터이다."><i class="fa fa-check"></i><b>4.4.1</b> 데이터 프레임의 열(변수)은 벡터이다.</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#데이터프레임을-행렬-형식으로-필터링"><i class="fa fa-check"></i><b>4.4.2</b> 데이터프레임을 행렬 형식으로 필터링</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch:R_Data_Structure.html"><a href="ch:R_Data_Structure.html#데이터-프레임의-문법과-조작"><i class="fa fa-check"></i><b>4.4.3</b> 데이터 프레임의 문법과 조작</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap:visulaize.html"><a href="chap:visulaize.html"><i class="fa fa-check"></i><b>5</b> R 데이터 시각화 기초</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#ggplot2-패키지-설치하기"><i class="fa fa-check"></i><b>5.1</b> ggplot2 패키지 설치하기</a></li>
<li class="chapter" data-level="5.2" data-path="chap:visulaize.html"><a href="chap:visulaize.html#sec:getStarted-ggplot2"><i class="fa fa-check"></i><b>5.2</b> ggplot2 시작하기</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#subsec:tryGgplot"><i class="fa fa-check"></i><b>5.2.1</b> ggplot2 그래프의 기본 문법</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chap:visulaize.html"><a href="chap:visulaize.html#sec:aesMapping"><i class="fa fa-check"></i><b>5.3</b> 그래프 속성과 데이터 열 매핑하기 (aesthetic mapping)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#범주형-변수와-색상color-속성의-매핑"><i class="fa fa-check"></i><b>5.3.1</b> 범주형 변수와 색상(<code>color</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap:visulaize.html"><a href="chap:visulaize.html#범주형-변수와-모양shape-속성의-매핑"><i class="fa fa-check"></i><b>5.3.2</b> 범주형 변수와 모양(<code>shape</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap:visulaize.html"><a href="chap:visulaize.html#연속형-변수와-크기size-색상color-투명도alpha-속성의-매핑"><i class="fa fa-check"></i><b>5.3.3</b> 연속형 변수와 크기(<code>size</code>), 색상(<code>color</code>), 투명도(<code>alpha</code>) 속성의 매핑</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap:visulaize.html"><a href="chap:visulaize.html#sec:commonProblems"><i class="fa fa-check"></i><b>5.4</b> ggplot 명령문을 입력할 때 자주 발생하는 문제들</a></li>
<li class="chapter" data-level="5.5" data-path="chap:visulaize.html"><a href="chap:visulaize.html#sec:layerAndGeom"><i class="fa fa-check"></i><b>5.5</b> geom 함수와 그래프 계층</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#geom-함수에서-속성-매핑하기"><i class="fa fa-check"></i><b>5.5.1</b> geom 함수에서 속성 매핑하기</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap:visulaize.html"><a href="chap:visulaize.html#sec:facets"><i class="fa fa-check"></i><b>5.6</b> 측면(facets)으로 나누어 그리기</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#facet_wrap로-일차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.1</b> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기</a></li>
<li class="chapter" data-level="5.6.2" data-path="chap:visulaize.html"><a href="chap:visulaize.html#facet_grid로-이차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.2</b> <code>facet_grid()</code>로 이차원 측면 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap:visulaize.html"><a href="chap:visulaize.html#기타-ggplot2의-문법-요소"><i class="fa fa-check"></i><b>5.7</b> 기타 ggplot2의 문법 요소</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="chap:visulaize.html"><a href="chap:visulaize.html#labelsmodification"><i class="fa fa-check"></i><b>5.7.1</b> 그래프 레이블을 조정하기</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III R 기술통계 분석</b></span></li>
<li class="chapter" data-level="6" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html"><i class="fa fa-check"></i><b>6</b> 기술통계 분석이란?</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#기술통계-기법의-중요성"><i class="fa fa-check"></i><b>6.1</b> 기술통계 기법의 중요성</a></li>
<li class="chapter" data-level="6.2" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#기술통계-기법의-분류"><i class="fa fa-check"></i><b>6.2</b> 기술통계 기법의 분류</a></li>
<li class="chapter" data-level="6.3" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#bizstatp-패키지의-course-데이터"><i class="fa fa-check"></i><b>6.3</b> <code>bizstatp</code> 패키지의 <code>course</code> 데이터</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#bizstatp-패키지-설치-방법"><i class="fa fa-check"></i><b>6.3.1</b> <code>bizstatp</code> 패키지 설치 방법</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#course-데이터"><i class="fa fa-check"></i><b>6.3.2</b> <code>course</code> 데이터</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#데이터-전체에-대한-요약-정보-파악하기"><i class="fa fa-check"></i><b>6.4</b> 데이터 전체에 대한 요약 정보 파악하기</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#summary-함수를-이용하여-변수-별로-통계-요약하기"><i class="fa fa-check"></i><b>6.4.1</b> <code>summary()</code> 함수를 이용하여 변수 별로 통계 요약하기</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch:introDescStat.html"><a href="ch:introDescStat.html#plot-함수를-이용한-변수-사이의-상관성-파악"><i class="fa fa-check"></i><b>6.4.2</b> <code>plot()</code> 함수를 이용한 변수 사이의 상관성 파악</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html"><i class="fa fa-check"></i><b>7</b> 범주형 변수에 대한 R 기술통계</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#한-범주형-변수에-대한-분포-분석"><i class="fa fa-check"></i><b>7.1</b> 한 범주형 변수에 대한 분포 분석</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#sec:freqTables"><i class="fa fa-check"></i><b>7.1.1</b> 범주형 변수 분포를 수치로 요약하기 - 빈도표 구하기</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#범주형-변수-분포를-그래프로-요약하기"><i class="fa fa-check"></i><b>7.1.2</b> 범주형 변수 분포를 그래프로 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#둘-이상의-범주형-변수의-상관성-분석"><i class="fa fa-check"></i><b>7.2</b> 둘 이상의 범주형 변수의 상관성 분석</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#범주형-변수의-상관성을-수치로-요약하기---교차표-만들기"><i class="fa fa-check"></i><b>7.2.1</b> 범주형 변수의 상관성을 수치로 요약하기 - 교차표 만들기</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#범주형-변수의-상관성을-그래프로-요약하기"><i class="fa fa-check"></i><b>7.2.2</b> 범주형 변수의 상관성을 그래프로 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#범주형-변수의-분석-사례"><i class="fa fa-check"></i><b>7.3</b> 범주형 변수의 분석 사례</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#관절염-치료-임상시험-데이터-분석"><i class="fa fa-check"></i><b>7.3.1</b> 관절염 치료 임상시험 데이터 분석</a></li>
<li class="chapter" data-level="7.3.2" data-path="ch:categoricalDescStat.html"><a href="ch:categoricalDescStat.html#subsec:BrokenMarriage"><i class="fa fa-check"></i><b>7.3.2</b> 이혼에 대한 사회조사 데이터 분석</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html"><i class="fa fa-check"></i><b>8</b> 수치형 변수에 대한 R 기술통계</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#한-수치형-변수에-대한-분포-분석"><i class="fa fa-check"></i><b>8.1</b> 한 수치형 변수에 대한 분포 분석</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#수치형-변수-분포를-수치로-요약하기"><i class="fa fa-check"></i><b>8.1.1</b> 수치형 변수 분포를 수치로 요약하기</a></li>
<li class="chapter" data-level="8.1.2" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#수치형-변수-분포를-그래프로-요약하기"><i class="fa fa-check"></i><b>8.1.2</b> 수치형 변수 분포를 그래프로 요약하기</a></li>
<li class="chapter" data-level="8.1.3" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#subsection:transformNumerice"><i class="fa fa-check"></i><b>8.1.3</b> 수치형 변수의 변환</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#둘-이상의-수치형-변수의-상관성-분석"><i class="fa fa-check"></i><b>8.2</b> 둘 이상의 수치형 변수의 상관성 분석</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#상관계수"><i class="fa fa-check"></i><b>8.2.1</b> 상관계수</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#산점도"><i class="fa fa-check"></i><b>8.2.2</b> 산점도</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#추세선-그리기"><i class="fa fa-check"></i><b>8.2.3</b> 추세선 그리기</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#수치형-변수의-변환"><i class="fa fa-check"></i><b>8.2.4</b> 수치형 변수의 변환</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#subsubsection:categorynum"><i class="fa fa-check"></i><b>8.2.5</b> 범주형 변수를 조건으로 수치형 변수의 상관성 탐색</a></li>
<li class="chapter" data-level="8.2.6" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#수치형-변수를-조건으로-두-수치형-변수의-상관성-분석"><i class="fa fa-check"></i><b>8.2.6</b> 수치형 변수를 조건으로 두 수치형 변수의 상관성 분석</a></li>
<li class="chapter" data-level="8.2.7" data-path="ch:numericDescStat.html"><a href="ch:numericDescStat.html#ggpairs를-이용한-수치형-변수를-한-번에-분석하기"><i class="fa fa-check"></i><b>8.2.7</b> <code>ggpairs()</code>를 이용한 수치형 변수를 한 번에 분석하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html"><i class="fa fa-check"></i><b>9</b> 범주형 변수와 수치형 변수의 관계 분석</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#범주별로-수치형-변수에-대해-통계-요약하기"><i class="fa fa-check"></i><b>9.1</b> 범주별로 수치형 변수에 대해 통계 요약하기</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#한-범주형-변수를-조건으로-수치형-변수를-통계-요약하기"><i class="fa fa-check"></i><b>9.1.1</b> 한 범주형 변수를 조건으로 수치형 변수를 통계 요약하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#여러-범주형-변수를-조건으로-수치형-변수를-통계-요약하기"><i class="fa fa-check"></i><b>9.1.2</b> 여러 범주형 변수를 조건으로 수치형 변수를 통계 요약하기</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#범주별-수치-변수의-분포-그래프"><i class="fa fa-check"></i><b>9.2</b> 범주별 수치 변수의 분포 그래프</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#상자-그래프"><i class="fa fa-check"></i><b>9.2.1</b> 상자 그래프</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch:categorical-numeric.html"><a href="ch:categorical-numeric.html#범주별로-수치형-변수의-분포-모양을-비교하기"><i class="fa fa-check"></i><b>9.2.2</b> 범주별로 수치형 변수의 분포 모양을 비교하기</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV R 추론통계 분석</b></span></li>
<li class="chapter" data-level="10" data-path="ch:hypoTest.html"><a href="ch:hypoTest.html"><i class="fa fa-check"></i><b>10</b> 가설검정이란?</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch:hypoTest.html"><a href="ch:hypoTest.html#가설의-설정"><i class="fa fa-check"></i><b>10.1</b> 가설의 설정</a></li>
<li class="chapter" data-level="10.2" data-path="ch:hypoTest.html"><a href="ch:hypoTest.html#검정통계량과-표본-분포"><i class="fa fa-check"></i><b>10.2</b> 검정통계량과 표본 분포</a></li>
<li class="chapter" data-level="10.3" data-path="ch:hypoTest.html"><a href="ch:hypoTest.html#기각역과-유의수준"><i class="fa fa-check"></i><b>10.3</b> 기각역과 유의수준</a></li>
<li class="chapter" data-level="10.4" data-path="ch:hypoTest.html"><a href="ch:hypoTest.html#유의확률-p-값p-value"><i class="fa fa-check"></i><b>10.4</b> 유의확률 p-값(p-value)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html"><i class="fa fa-check"></i><b>11</b> 범주형 변수에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#단일-모집단의-모비율에-대한-가설검정"><i class="fa fa-check"></i><b>11.1</b> 단일 모집단의 모비율에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#binom.test로-단일-모집단-모비율-검정하기"><i class="fa fa-check"></i><b>11.1.1</b> <code>binom.test()</code>로 단일 모집단 모비율 검정하기</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#빈도표를-입력변수로-전달하기"><i class="fa fa-check"></i><b>11.1.2</b> 빈도표를 입력변수로 전달하기</a></li>
<li class="chapter" data-level="11.1.3" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#prop.test로-단일-모집단-모비율-검정하기"><i class="fa fa-check"></i><b>11.1.3</b> <code>prop.test()</code>로 단일 모집단 모비율 검정하기</a></li>
<li class="chapter" data-level="11.1.4" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#정규분포를-이용한-비율-검정에서-연속성-수정"><i class="fa fa-check"></i><b>11.1.4</b> 정규분포를 이용한 비율 검정에서 연속성 수정</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#여러-모집단의-모비율의-차이에-대한-가설검정"><i class="fa fa-check"></i><b>11.2</b> 여러 모집단의 모비율의 차이에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#prop.test를-이용한-두-모집단의-모비율의-차이-검정"><i class="fa fa-check"></i><b>11.2.1</b> <code>prop.test()</code>를 이용한 두 모집단의 모비율의 차이 검정</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#교차표를-이용하여-여러-모집단의-모비율-차이를-검정하기"><i class="fa fa-check"></i><b>11.2.2</b> 교차표를 이용하여 여러 모집단의 모비율 차이를 검정하기</a></li>
<li class="chapter" data-level="11.2.3" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#fisher의-exact-test"><i class="fa fa-check"></i><b>11.2.3</b> Fisher의 Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#적합성-검정"><i class="fa fa-check"></i><b>11.3</b> 적합성 검정</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#빈도표를-이용한-적합성-검정"><i class="fa fa-check"></i><b>11.3.1</b> 빈도표를 이용한 적합성 검정</a></li>
<li class="chapter" data-level="11.3.2" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#몬테-카를로-시뮬레이션을-이용한-적합도-가설검정"><i class="fa fa-check"></i><b>11.3.2</b> 몬테 카를로 시뮬레이션을 이용한 적합도 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#독립성-검정"><i class="fa fa-check"></i><b>11.4</b> 독립성 검정</a></li>
<li class="chapter" data-level="11.5" data-path="ch:categoricalTest.html"><a href="ch:categoricalTest.html#범주형-변수의-가설검정에-대한-정리"><i class="fa fa-check"></i><b>11.5</b> 범주형 변수의 가설검정에 대한 정리</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch:numericTest.html"><a href="ch:numericTest.html"><i class="fa fa-check"></i><b>12</b> 수치형 변수에 대한 가설검정</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch:numericTest.html"><a href="ch:numericTest.html#단일-모집단에서의-모평균에-대한-검정"><i class="fa fa-check"></i><b>12.1</b> 단일 모집단에서의 모평균에 대한 검정</a></li>
<li class="chapter" data-level="12.2" data-path="ch:numericTest.html"><a href="ch:numericTest.html#두-모집단에서의-모평균-차이에-대한-검정"><i class="fa fa-check"></i><b>12.2</b> 두 모집단에서의 모평균 차이에 대한 검정</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch:numericTest.html"><a href="ch:numericTest.html#등분산이-가정되는-경우의-모평균-차이-검정"><i class="fa fa-check"></i><b>12.2.1</b> 등분산이 가정되는 경우의 모평균 차이 검정</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch:numericTest.html"><a href="ch:numericTest.html#등분산이-가정될-수-없는-경우의-모평균의-차이-검정"><i class="fa fa-check"></i><b>12.2.2</b> 등분산이 가정될 수 없는 경우의 모평균의 차이 검정</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch:numericTest.html"><a href="ch:numericTest.html#데이터프레임에서-모평균-차이-검정"><i class="fa fa-check"></i><b>12.2.3</b> 데이터프레임에서 모평균 차이 검정</a></li>
<li class="chapter" data-level="12.2.4" data-path="ch:numericTest.html"><a href="ch:numericTest.html#짝진-표본에서의-모평균-차이에-대한-가설검정"><i class="fa fa-check"></i><b>12.2.4</b> 짝진 표본에서의 모평균 차이에 대한 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch:numericTest.html"><a href="ch:numericTest.html#셋-이상의-모집단에서의-모평균-차이에-대한-검정"><i class="fa fa-check"></i><b>12.3</b> 셋 이상의 모집단에서의 모평균 차이에 대한 검정</a></li>
<li class="chapter" data-level="12.4" data-path="ch:numericTest.html"><a href="ch:numericTest.html#정규성을-따르지-않을-때의-가설검정"><i class="fa fa-check"></i><b>12.4</b> 정규성을 따르지 않을 때의 가설검정</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ch:numericTest.html"><a href="ch:numericTest.html#두-모집단의-중위수에-대한-비모수적-가설검정"><i class="fa fa-check"></i><b>12.4.1</b> 두 모집단의 중위수에 대한 비모수적 가설검정</a></li>
<li class="chapter" data-level="12.4.2" data-path="ch:numericTest.html"><a href="ch:numericTest.html#짝진표본에-대한-검정"><i class="fa fa-check"></i><b>12.4.2</b> 짝진표본에 대한 검정</a></li>
<li class="chapter" data-level="12.4.3" data-path="ch:numericTest.html"><a href="ch:numericTest.html#순열-검정"><i class="fa fa-check"></i><b>12.4.3</b> 순열 검정</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch:anova.html"><a href="ch:anova.html"><i class="fa fa-check"></i><b>13</b> 분산 분석</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch:anova.html"><a href="ch:anova.html#일원분류-분산-분석"><i class="fa fa-check"></i><b>13.1</b> 일원분류 분산 분석</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch:anova.html"><a href="ch:anova.html#개념"><i class="fa fa-check"></i><b>13.1.1</b> 개념</a></li>
<li class="chapter" data-level="13.1.2" data-path="ch:anova.html"><a href="ch:anova.html#aov-함수"><i class="fa fa-check"></i><b>13.1.2</b> <code>aov()</code> 함수</a></li>
<li class="chapter" data-level="13.1.3" data-path="ch:anova.html"><a href="ch:anova.html#다중-비교"><i class="fa fa-check"></i><b>13.1.3</b> 다중 비교</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch:anova.html"><a href="ch:anova.html#이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2</b> 이원분류 분산 분석</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch:anova.html"><a href="ch:anova.html#교호작용이-없는-이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2.1</b> 교호작용이 없는 이원분류 분산 분석</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch:anova.html"><a href="ch:anova.html#교호작용이-있는-이원분류-분산-분석"><i class="fa fa-check"></i><b>13.2.2</b> 교호작용이 있는 이원분류 분산 분석</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch:anova.html"><a href="ch:anova.html#공분산-분석"><i class="fa fa-check"></i><b>13.3</b> 공분산 분석</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 이용한 통계 분석 (개정판)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:categoricalTest" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> 범주형 변수에 대한 가설검정<a href="ch:categoricalTest.html#ch:categoricalTest" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>이 장에서는 <strong>R</strong>을 이용하여 범주형 변수에 대해 가설검정하는 방법을 알아본다.</p>
<div id="단일-모집단의-모비율에-대한-가설검정" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> 단일 모집단의 모비율에 대한 가설검정<a href="ch:categoricalTest.html#단일-모집단의-모비율에-대한-가설검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>모집단이 하나일 때, 특정 범주가 차지하는 비율 <span class="math inline">\(p\)</span>에 대해 가설검정하는 방법을 살펴보자. 모집단에서의 관심의 대상이 되는 범주의 비율 <span class="math inline">\(p\)</span>를 모비율이라고 한다. 여기서 관심의 대상이 되는 범주는 문제마다 다르게 정의될 수 있다. 모비율이 어떤 전염병에 대한 항체 보유자에 대한 비율일 수도 있고, 어떤 정단에 대한 지지율일 수도 있다.</p>
<p>가설검정을 위해 모집단에서 <span class="math inline">\(n\)</span> 개의 표본을 추출하였다고 하자. 그 중 <span class="math inline">\(x\)</span> 개가 해당 범주의 관측도수라면 표본비율 <span class="math inline">\(\hat{p}\)</span>은 다음과 같이 계산된다.</p>
<p><span class="math display">\[
\hat{p} = x / n.
\]</span></p>
<p>단일 모집단의 모비율에 대한 가설검정에서 귀무가설은 모집단의 비율 <span class="math inline">\(p\)</span>가 특정값 <span class="math inline">\(p_0\)</span>이다로 설정된다. 반면 대립가설은 모비율 <span class="math inline">\(p\)</span>가 <span class="math inline">\(p_0\)</span>가 아니다, 더 크다, 더 작다 중 하나로 설정된다. 앞서 보았던 Example <a href="ch:hypoTest.html#exm:fairCoin">10.1</a>의 동전의 앞면이 나올 비율에 대한 가설검은 단일 모집단의 모비율에 대한 가설검정의 예라 할 수 있다.</p>
<p>모비율에 대한 가설검정은 검정통계량과 표본분포로 다음 두 가지 중 하나가 사용된다.</p>
<ul>
<li>이항분포로 검정: 가설검정에 사용할 검정통계량으로 표본에서의 특정 범주가 관측된 수 <span class="math inline">\(x\)</span>를 사용한다. 그러면 모집단의 크기가 크고 표본의 선택이 서로 독립이라면 검정통계량 <span class="math inline">\(x\)</span>는 모비율이 <span class="math inline">\(p = p_0\)</span>라는 귀무가설 하에 이항분포 <span class="math inline">\(Binom(n, p_0)\)</span>를 따른다.</li>
</ul>
<p><span class="math display">\[
x \sim Binom(n, p_0).
\]</span></p>
<ul>
<li>정규분포로 검정: 검정통계량으로 표본비율 <span class="math inline">\(\hat{p}\)</span>을 사용하다. 그러면 <span class="math inline">\(\hat{p}\)</span>은 모비율이 <span class="math inline">\(p = p_0\)</span>라는 귀무가설 하에 정규분포 <span class="math inline">\(N(p_0, \sqrt{p_0(1-p_0)/n})\)</span>을 근사적으로 따른다. 따라서 다음과 같이 표준정규분포를 따른는 검정통계량 <span class="math inline">\(T\)</span>를 사용하여 가설검정을 수행한다.</li>
</ul>
<p><span class="math display">\[
T = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1 - p_0)}{n}}} \sim N(0, 1)
\]</span></p>
<p>이항분포 검정은 표본의 추출이 독립적이라는 가정 하에 정확한 확률분포이고, 정규분포 검정은 검정통계량에 대한 근사적 확률분포이므로 가능하면 이항분포 검정을 사용하는 것이 좋다. 그러나 예전에는 컴퓨터의 계산 능력이 높지 않았기 때문에 비율 검정을 사용하는 경우가 많았다. 다만 <span class="math inline">\(n\)</span>이 매우 크고 <span class="math inline">\(np\)</span>의 값이 충분히 큰 경우에는 이항분포 검정이나 정규분포 검정의 차이가 거의 없다. 이 경우에는 계산 시간의 절약을 위하여 정규분포 검정을 사용할 수 있다.</p>
<p>대립가설에 따라 기각역의 위치는 다음과 같이 정리될 수 있다.</p>
<table>
<colgroup>
<col width="38%" />
<col width="30%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">귀무가설 (<span class="math inline">\(H_0\)</span>)</th>
<th align="center">대립가설 (<span class="math inline">\(H_1\)</span>)</th>
<th align="center">기각역의 위치</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(p = p_0\)</span></td>
<td align="center"><span class="math inline">\(p \neq p_0\)</span></td>
<td align="center">양측검정</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(p = p_0 \, (p \ge p_0)\)</span></td>
<td align="center"><span class="math inline">\(p &lt; p_0\)</span></td>
<td align="center">왼쪽 단측검정</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(p = p_0 \, (p \le p_0)\)</span></td>
<td align="center"><span class="math inline">\(p &gt; p_0\)</span></td>
<td align="center">오른쪽 단측검정</td>
</tr>
</tbody>
</table>
<p>왜냐하면 대립가설이 <span class="math inline">\(p &lt; p_0\)</span>가 채택되려면 표본의 관측도수 <span class="math inline">\(x\)</span>가 귀무가설이 맞다고 했을 때의 이항분포에서 예외적으로 작게 나와야 한다. 그러므로 분포의 왼쪽을 기각역으로 설정하는 왼쪽 단측검정을 한다. 마찬가지로 대립가설이 <span class="math inline">\(p &gt; p_0\)</span>가 채택되려면 관측도수 <span class="math inline">\(x\)</span>가 귀무가설 하의 이항분포에서 예외적으로 크게 나와야 한다. 그러므로 분포의 오른쪽을 기각역으로 설정하는 오른쪽 단측검정을 한다. 대립가설이 <span class="math inline">\(p \neq p_0\)</span>이면 관측도수 <span class="math inline">\(x\)</span>가 귀무가설 하의 이항분포에서 예외적으로 작거나 크게 나올 때 대립가설을 채택하므로, 기각역은 분포의 양쪽에 모두 있게 된다. 같은 방식으로 표본비율 <span class="math inline">\(\hat{p}\)</span>의 값이 대립가설이 받아들여지려면 귀무가설의 모비율 <span class="math inline">\(p_0\)</span>보다 작아야 하는지, 커야 하는지를 생각해 보면 기각역의 위치가 위의 표처럼 되는 것을 쉽게 이해할 수 있다.</p>
<div id="binom.test로-단일-모집단-모비율-검정하기" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> <code>binom.test()</code>로 단일 모집단 모비율 검정하기<a href="ch:categoricalTest.html#binom.test로-단일-모집단-모비율-검정하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>R</strong>의 기본 패키지인 <code>stat</code> 패키지의 <code>binom.test()</code> 함수는 이항분포를 사용하여 단일 모집단에 대한 모비율에 대한 가설검정을 수행한다.</p>
<p><code>binom.test()</code> 함수를 이용하여 단일 모집단의 모집율에 대한 가설검정을 하는 문법은 다음과 같다.</p>
<pre><code>binom.test(x = 관측도수, n = 표본수, p = 귀무가설_모비율, alternative = &quot;대립가설_종류&quot;)
binom.test(x = 관측도수, n = 표본수, p = 귀무가설_모비율, 
    alternative = &quot;대립가설_종류&quot;, conf.level = 신뢰수준)  # 신뢰구간의 신뢰수준을 조정</code></pre>
<p><code>binom.test()</code> 함수에 사용되는 인수는, <code>stat</code> 패키지의 가설검정 함수들이 공통적으로 사용하는 인수도 있고, 모비율 검정에만 관련된 인수가 있다. <code>binom.test()</code>의 처음 세 인수는 모비율 검정에만 관련된 인수이다.</p>
<ul>
<li><code>x</code>: 표본에서 특정 범주가 발생한 횟수</li>
<li><code>n</code>: 표본의 크기</li>
<li><code>p</code>: 귀무가설의 모비율 <span class="math inline">\(p_0\)</span></li>
</ul>
<p>그 다음의 두 인수는 <code>stat</code> 패키지의 가설검정 함수들이 공통적으로 사용하는 인수이다.</p>
<ul>
<li><code>alternative</code>: 대립가설의 종류를 지정한다. 대립가설이 <span class="math inline">\(p \neq p_0\)</span>이면 양측 검정을 의미하는 <code>"two.sided"</code>로, <span class="math inline">\(p &lt; p_0\)</span>이면 왼쪽 검증을 의미하는 <code>"less"</code>로, <span class="math inline">\(p &gt; p_0\)</span>이면 오른쪽 검정을 의미하는 <code>"greater"</code>로 값을 입력한다.</li>
<li><code>conf.level</code>: 대부분의 가설검정 함수는 신뢰구간도 함께 알려주는데 이 인수는 신뢰구간의 신뢰수준을 지정한다. 기본값은 0.95로 95% 신뢰구간을 계산하여 알려준다.</li>
</ul>
<div class="example">
<p><span id="exm:binom-test1" class="example"><strong>Example 11.1  </strong></span>어떤 회사 제품의 불량률이 10%였다고 하자.
새로운 공정을 도입한 후 300개의 제품을 생산한 후 불량품을 조사하였더니 20개가 발견되었다.
새로운 공정 도입으로 불량률이 저하되었는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:binom-test1">11.1</a>의 가설검정은 불량률이 감소했다는 것을 검정하고자 하는 것이다. 그러므로 <span class="math inline">\(p\)</span>를 새 공정의 불량률이라고 하면 귀무가설과 대립가설은 다음과 같이 설정한다. 왜냐하면 귀무가설은 일반적으로 받아들여지는 가설이다. 이 예에서 지금까지의 불량률이 10%였으므로 특별한 증거가 있지 않다면 새로운 공정의 불량률도 10%라고 생각하는 것이 합리적이다. 대립가설은 표본에서 특별한 증거가 발생하면 채택하고자 하는 가설이 된다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p = 0.1 \\
H_1: &amp; \quad p &lt; 0.1
\end{align}
\]</span></p>
<p><code>binom.test()</code>을 사용하여 가설검정을 하면 다음과 같은 결과를 얻는다.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="ch:categoricalTest.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">300</span>, <span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  20 and 300
number of successes = 20, number of trials = 300, p-value = 0.02868
alternative hypothesis: true probability of success is less than 0.1
95 percent confidence interval:
 0.00000000 0.09540198
sample estimates:
probability of success 
            0.06666667 </code></pre>
<p>인수들을 순서에 맞게 기술하면 인수의 이름을 생략하거나 일부만 기술해도 된다. 인수의 이름을 기술하면 순서는 중요하지 않다. 다음 명령문은 모두 동일한 결과를 준다.</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="ch:categoricalTest.html#cb852-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">300</span>, <span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb852-2"><a href="ch:categoricalTest.html#cb852-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">300</span>, <span class="fl">0.1</span>, <span class="st">&quot;less&quot;</span>)</span>
<span id="cb852-3"><a href="ch:categoricalTest.html#cb852-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(<span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">300</span>)</span></code></pre></div>
<p>이항분포 검정을 통해 우리는 다음 사실을 알 수 있다.</p>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 0.0666667이다.</li>
<li>p-값은 0.028679로 유의수준 0.05에서 귀무가설을 기각한다. (대립가설을 채택한다.)</li>
</ul>
<div class="example">
<p><span id="exm:binom-test-course" class="example"><strong>Example 11.2  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
이 과목은 평균적으로 수강생의 여학생 비율이 30%였다.<br />
현재 이 과목 수강생의 여학생 비율의 과거와 달라졌다고 볼 수 있는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:binom-test-course">11.2</a>의 가설검정은 여학생의 비율이 달라졌는지를 검정하는 것이다. <span class="math inline">\(p\)</span>를 수강생 중 여학생의 비율이라고 하면 귀무가설과 대립가설을 다음과 같이 설정한다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p = 0.3 \\
H_1: &amp; \quad p \neq 0.3
\end{align}
\]</span></p>
<p><code>binom.test()</code>을 사용하여 가설검정을 하려면, <code>x</code>와 <code>n</code>의 값을 구해야 한다. Example <a href="ch:categoricalTest.html#exm:binom-test-course">11.2</a>에서는 <code>x</code>는 여학생의 수, <code>n</code>은 전체 수강생이 된다. 이를 구하기 위해서는 성별 수강생의 빈도표가 필요하다.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="ch:categoricalTest.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(bizstatp)</span>
<span id="cb853-2"><a href="ch:categoricalTest.html#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(course)</span></code></pre></div>
<pre><code>   major year gender class mid final   hw score
1 Others    4      M     1  62    66 83.6 73.47
2 Others    3      F     1  46    37 88.7 61.50
3     ME    2      M     1  94    82 87.9 89.18
4     ME    2      M     1  73    71 88.7 78.47
5     ME    2      M     1  96    93 90.6 93.88
6     ME    2      M     1  54    43 84.3 64.39</code></pre>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="ch:categoricalTest.html#cb855-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tg <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> gender, <span class="at">data =</span> course)</span>
<span id="cb855-2"><a href="ch:categoricalTest.html#cb855-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tg</span></code></pre></div>
<pre><code>gender
 F  M 
18 27 </code></pre>
<p><code>x</code>는 빈도표의 첫번째 요소이고 <code>n</code>은 빈도표의 모든 관측도수를 합하면 구할 수 있다. 그러므로 이 값을 <code>binom.test()</code>에 입력하면 다음 결과를 얻는다..</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="ch:categoricalTest.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(tg[<span class="dv">1</span>], <span class="fu">sum</span>(tg), <span class="at">p =</span> <span class="fl">0.3</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  tg[1] and sum(tg)
number of successes = 18, number of trials = 45, p-value = 0.1457
alternative hypothesis: true probability of success is not equal to 0.3
95 percent confidence interval:
 0.2569759 0.5566865
sample estimates:
probability of success 
                   0.4 </code></pre>
<p>이항분포 검정을 통해 우리는 다음 사실을 알 수 있다.</p>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 0.4이다.</li>
<li>p-값은 0.1457496로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)</li>
<li>모비율의 95% 신뢰구간은 0.2569759에서 0.5566865이다.</li>
</ul>
<div class="example">
<p><span id="exm:binom-test-course2" class="example"><strong>Example 11.3  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
이 과목은 과거에 평균적으로 수강생 중 2학년 학생의 비율이 80%였다.<br />
현재 이 과목의 2학년 학생의 수강 비율이 과거보다 줄었다고 볼 수 있는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:binom-test-course2">11.3</a>의 가설검정은 2학년 학생의 수강 비율이 줄어들었는지를 검정하고자 하는 것이다. <span class="math inline">\(p\)</span>를 2학년 학생의 수강 비율이라고 하면 귀무가설과 대립가설은 다음과 같이 설정한다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p = 0.8 \\
H_1: &amp; \quad p &lt; 0.8
\end{align}
\]</span></p>
<p><code>binom.test()</code>를 이용하여 가설검정을 하려면 먼저 빈도표를 구해야 한다. 범주형 변수의 범주가 세 개 이상인 경우 빈도표를 이용하여 가설검정할 때, 범주표에서 <code>x</code>의 위치를 정확히 지정하여야 한다. 이 예에서는 2학년 학생의 수는 빈도표의 2번째 요소이다. <code>n</code>은 전체 관측도수의 합으로 구하면 된다.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="ch:categoricalTest.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ty <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> year, <span class="at">data =</span> course)</span>
<span id="cb859-2"><a href="ch:categoricalTest.html#cb859-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ty</span></code></pre></div>
<pre><code>year
 1  2  3  4 
 1 32  9  3 </code></pre>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="ch:categoricalTest.html#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(ty[<span class="dv">2</span>], <span class="fu">sum</span>(ty), <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  ty[2] and sum(ty)
number of successes = 32, number of trials = 45, p-value = 0.09945
alternative hypothesis: true probability of success is less than 0.8
95 percent confidence interval:
 0.0000000 0.8198828
sample estimates:
probability of success 
             0.7111111 </code></pre>
<p>이항분포 검정을 통해 우리는 다음 사실을 알 수 있다.</p>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 0.7111111이다.</li>
<li>p-값은 0.0994542로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)</li>
</ul>
</div>
<div id="빈도표를-입력변수로-전달하기" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> 빈도표를 입력변수로 전달하기<a href="ch:categoricalTest.html#빈도표를-입력변수로-전달하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>범주형 변수를 빈도표로 요약한 후 가설검정하는 경우가 빈번하기 때문에 <code>binom.test()</code>와 뒤에서 볼 <code>prop.test()</code>는 첫번째 인수로 빈도표를 입력받아 가설검정을 수행할 수 있다. 빈도표를 직접 입력받아 가설검정할 때, <code>binom.test()</code>와 <code>prop.test()</code>는 빈도표의 첫번째 범주에 대한 비율에 대하여 가설 검정을 수행한다.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="ch:categoricalTest.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tg</span></code></pre></div>
<pre><code>gender
 F  M 
18 27 </code></pre>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="ch:categoricalTest.html#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(tg, <span class="at">p =</span> <span class="fl">0.3</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  tg
number of successes = 18, number of trials = 45, p-value = 0.1457
alternative hypothesis: true probability of success is not equal to 0.3
95 percent confidence interval:
 0.2569759 0.5566865
sample estimates:
probability of success 
                   0.4 </code></pre>
<p>이 경우 빈도표는 성별의 빈도표처럼 두 개의 범주로만 이루어져 있어야 한다. 학년의 빈도표처럼 3 개 이상의 범주가 있으면 앞에서 설명한 것처럼 직접 <code>x</code>와 <code>n</code> 인수를 각각 빈도표에서 지정하여 입력하여야 한다.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="ch:categoricalTest.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ty</span></code></pre></div>
<pre><code>year
 1  2  3  4 
 1 32  9  3 </code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="ch:categoricalTest.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">binom.test</span>(ty, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>Error in binom.test(ty, p = 0.8, alternative = &quot;less&quot;): &#39;x&#39;의 길이가 올바르지 않습니다</code></pre>
</div>
<div id="prop.test로-단일-모집단-모비율-검정하기" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> <code>prop.test()</code>로 단일 모집단 모비율 검정하기<a href="ch:categoricalTest.html#prop.test로-단일-모집단-모비율-검정하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>prop.test()</code> 함수는 정확한 이항분포 대신 근사적인 표준정규분포를 이용하여 가설검정을 수행한다.
단일 모집단의 모비율에 대한 가설검정의 경우 <code>prop.test()</code>의 인수의 사용방법은 <code>binom.test()</code>와 동일하다.</p>
<p>다음은 Example <a href="ch:categoricalTest.html#exm:binom-test1">11.1</a> 문제를 <code>prop.test()</code> 함수를 이용하여 가설검정을 수행한 결과이다. <code>binom.test()</code>에서 검정통계량만 달라지므로 귀무가설과 대립가설은 모두 동일하다.</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="ch:categoricalTest.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(<span class="dv">20</span>, <span class="dv">300</span>, <span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    1-sample proportions test with continuity correction

data:  20 out of 300, null probability 0.1
X-squared = 3.3426, df = 1, p-value = 0.03375
alternative hypothesis: true p is less than 0.1
95 percent confidence interval:
 0.00000000 0.09635565
sample estimates:
         p 
0.06666667 </code></pre>
<p>비율 검정을 통해 우리는 다음 사실을 알 수 있다.</p>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 0.0666667이다. (이항분포 검정과 동일하다.)</li>
<li>p-값은 0.0337541로 유의수준 0.05에서 귀무가설을 기각한다. (대립가설을 채택한다.) p-값은 이항분포 검정과 조금 다른 것을 볼 수 있다. 비율 검정은 근사치로 분포를 계산하므로 <code>n</code>이 매우 크지 않으면 정확한 검정인 이항분포 검정과는 차이가 발생한다.</li>
<li>모비율의 95% 신뢰구간은 0에서 0.0963556이다. 신뢰구간도 사용되는 추정 통계량이 다르므로 이항분포 검정의 결과와는 조금 값이 다르다.</li>
</ul>
<p>다음은 Example <a href="ch:categoricalTest.html#exm:binom-test-course">11.2</a> 문제를 <code>prop.test()</code> 함수를 이용하여 비율 검정을 수행한 결과이다. 이 문제도 검정통계량만 달라지므로 귀무가설과 대립가설은 모두 동일하다.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="ch:categoricalTest.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(tg, <span class="at">p =</span> <span class="fl">0.3</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    1-sample proportions test with continuity correction

data:  tg, null probability 0.3
X-squared = 1.6931, df = 1, p-value = 0.1932
alternative hypothesis: true p is not equal to 0.3
95 percent confidence interval:
 0.2606306 0.5562701
sample estimates:
  p 
0.4 </code></pre>
<p>비율 검정을 통해 우리는 다음 사실을 알 수 있다.</p>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 0.4이다. (이항분포 검정과 동일하다.)</li>
<li>p-값은 0.19319로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.) p-값은 이항분포 검정과 조금 다른 것을 볼 수 있다. 비율 검정은 근사치로 분포를 계산하므로 <code>n</code>이 매우 크지 않으면 정확한 검정인 이항분포 검정과는 차이가 발생한다.</li>
<li>모비율의 95% 신뢰구간은 0.2606306에서 0.5562701이다. 신뢰구간도 사용되는 추정 통계량이 다르므로 이항분포 검정의 결과와는 조금 값이 다르다.</li>
</ul>
</div>
<div id="정규분포를-이용한-비율-검정에서-연속성-수정" class="section level3 hasAnchor" number="11.1.4">
<h3><span class="header-section-number">11.1.4</span> 정규분포를 이용한 비율 검정에서 연속성 수정<a href="ch:categoricalTest.html#정규분포를-이용한-비율-검정에서-연속성-수정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>prop.test()</code> 함수는 <code>binom.test()</code> 함수보다 <code>correct</code>라는 인수를 하나 더 가지고 있다.
범주형 변수의 발생 건수 <code>x</code>는 0 또는 자연수의 값을 가지므로 이산형 확률변수이다. 그러나 정규분포를 사용하여 비율 검정을 할 경우에 검정통계량 T를 연속형 확률변수로 가정하여 p-값 등이 계산된다. 이러한 이산형 확률변수와 연속형 확률변수 사이의 불일치를 해소하기 위하여 이산형 확률변수의 값 <code>x</code>를 마치 연속형 확률변수의 값인 것처럼 수정하게 되는데 이를 연속성 수정이라고 한다. 예를 들어 <code>x=10</code>이라는 이산형 값은 연속적인 수직선 상에서 <code>[9.5, 10.5)</code>의 구간을 의미하는 것으로 수정한다. <code>prop.test()</code>는 기본적으로 연속형 수정을 하여 가설검정을 수행한다. 연속형 수정을 하지 않고 가설점을 하려면 <code>correct = FALSE</code>로 인수를 설정한다. 다음은 Example <a href="ch:categoricalTest.html#exm:binom-test1">11.1</a>을 연속형 수정을 하지 않고 정규분포로 비율 검정을 수행한 결과이다. 연속형 수정을 한 결과와 p-값이 조금 다른 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="ch:categoricalTest.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(<span class="dv">20</span>, <span class="dv">300</span>, <span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
    1-sample proportions test without continuity correction

data:  20 out of 300, null probability 0.1
X-squared = 3.7037, df = 1, p-value = 0.02715
alternative hypothesis: true p is less than 0.1
95 percent confidence interval:
 0.00000000 0.09443818
sample estimates:
         p 
0.06666667 </code></pre>
</div>
</div>
<div id="여러-모집단의-모비율의-차이에-대한-가설검정" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> 여러 모집단의 모비율의 차이에 대한 가설검정<a href="ch:categoricalTest.html#여러-모집단의-모비율의-차이에-대한-가설검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="prop.test를-이용한-두-모집단의-모비율의-차이-검정" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> <code>prop.test()</code>를 이용한 두 모집단의 모비율의 차이 검정<a href="ch:categoricalTest.html#prop.test를-이용한-두-모집단의-모비율의-차이-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>범주형 변수의 특정 범주에 대해 두 집단에서 모비율이 차이를 가설검정하는 방법을 살펴보자. 두 집단의 모비율의 차이를 검정하는 대표적인 예가 어떤 백신이 전염병에 효과가 있는지 없는지를 가설검정하는 것이다. 진짜 백신을 투여한 집단과 가짜 백신을 투여한 집단에서 전염병에 걸리는 비율에 차이가 있는지를 살펴보아 백신의 효과에 대해 가설검정을 수행한다. 이 때의 귀무가설은 백신은 효과가 없으므로 ’두 집단에서 전염병에 걸리는 비율은 같다’이고, 대립가설은 ’진짜 백신을 맞은 집단에서 전염병에 걸리는 비율이 가짜 백신을 맞은 집단보다 전염병에 걸리는 비율이 낮다’이다.</p>
<p>두 모집단의 모비율에 대해 가설검정을 하려면 두 집단에서 각각 <span class="math inline">\(n_1\)</span>과 <span class="math inline">\(n_2\)</span> 개의 표본을 추출하하여 관심있는 범주의 관측도수 <span class="math inline">\(x_1\)</span>과 <span class="math inline">\(x_2\)</span>를 측정한다. 그리고는 두 표본에서의 표본비율 <span class="math inline">\(\hat{p}_1\)</span>과 <span class="math inline">\(\hat{p}_2\)</span>을 다음과 같이 계산한다.</p>
<p><span class="math display">\[
\hat{p}_1 = x_1 / n_1, \quad \hat{p}_2 = x_2 / n_2.
\]</span></p>
<p>두 집단의 모비율 차이에 대한 검정의 귀무가설은 ’두 모집단의 모비율 <span class="math inline">\(p_1\)</span>과 <span class="math inline">\(p_2\)</span>은 같다’로 수립하고, 대립가설은 모비율이 같지 않다, <span class="math inline">\(p_1\)</span>이 더 크다, 작다로 수립한다. <span class="math inline">\(n_1\)</span>과 <span class="math inline">\(n_2\)</span>가 충분히 크면 두 집단의 모비율 차이의 검정통계량 <span class="math inline">\(T\)</span>는 다음과 같이 정의될 수 있고 근사적으로 표준정규분포를 따른다.</p>
<p><span class="math display">\[
T = \frac{\hat{p}_1 - \hat{p}_2}{ \sqrt{ \hat{p} ( 1- \hat{p}) \left( \frac{1}{n_1} + \frac{1}{n_2} \right)}} \sim N(0, 1)
\]</span></p>
<p>단, <span class="math inline">\(\hat{p} = (x_1 + x_2) / (n_1 + n_2)\)</span>.</p>
<p>대립가설에 따라 유의수준 <span class="math inline">\(\alpha\)</span> 에 대해 기각역은 다음 표와 같다.</p>
<table>
<colgroup>
<col width="20%" />
<col width="24%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">귀무가설 (<span class="math inline">\(H_0\)</span>)</th>
<th align="center">대립가설 (<span class="math inline">\(H_1\)</span>)</th>
<th align="center">기각역</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(p_1 = p_2\)</span></td>
<td align="center"><span class="math inline">\(p_1 \neq p_2\)</span></td>
<td align="center"><span class="math inline">\(T \ge z_{\alpha/2}\)</span> 또는 <span class="math inline">\(T \le -z_{\alpha/2}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(p_1 = p_2\)</span></td>
<td align="center"><span class="math inline">\(p_1 &lt; p_2\)</span></td>
<td align="center"><span class="math inline">\(T \le -z_{\alpha}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(p_1 = p_2\)</span></td>
<td align="center"><span class="math inline">\(p_1 &gt; p_2\)</span></td>
<td align="center"><span class="math inline">\(T \ge z_{\alpha}\)</span></td>
</tr>
</tbody>
</table>
<div class="example">
<p><span id="exm:prop-test-two" class="example"><strong>Example 11.4  </strong></span>기존 공정에서 400개를 생산했을 때 30개의 불량률이 발생하였다.
새로운 공정을 도입하고 300개의 제품을 생산한 후 불량품을 조사하였더니 20개가 발견되었다.
새로운 공정 도입으로 불량률이 저하되었는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-two">11.4</a>은 새 공정의 불량률이 감소했다는 것을 검정하는 것이므로 기존 공정과 새 공정의 불량률을 <span class="math inline">\(p_1\)</span>과 <span class="math inline">\(p_2\)</span>라고 하면 귀무가설과 대립가설은 다음과 같다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p_1 = p_2 \\
H_1: &amp; \quad p_1 &gt; p_2
\end{align}
\]</span></p>
<p><strong>R</strong>의 <code>prop.test()</code> 함수는 두 모집단의 모비율의 차이 검정에도 사용된다.</p>
<pre><code>prop.test(x = 관측도수_벡터, n = 표본수_벡터, alternative = &quot;대립가설_종류&quot;)</code></pre>
<p><code>prop.test()</code> 함수를 여러 모집단의 모비율 차이를 검정할 때, 단일 모집단의 모비율 검정과의 차이는 다음과 같다.</p>
<ul>
<li><code>x</code>와 <code>n</code>에 두 표본에서의 해당 범주의 관측도수와 표본 크기를 크기가 2인 벡터로 입력해야 한다. 이 때 주의해야 할 것은 <code>x</code>와 <code>n</code> 벡터에 두 집단의 정보를 나열할 때 귀무가설과 대립가설에서 첫 번째 모집단으로 설정된 표본의 값이 먼저 나열되어야 한다.</li>
<li>귀무가설이 두 모비율이 같다는 것이기 때문에, 단일 모집단에 대한 검정처럼 모비율을 특정 값으로 설정하지 않는다. 따라서 <code>p</code> 인수를 사용하지 않는다.</li>
</ul>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-two">11.4</a>에서는 기존 공정을 첫 번째 모집단으로 신규 공정을 두 번째 모집단으로 설정하여 대립가설을 설정하였으므로, <code>x</code>와 <code>n</code>도 해당 순서로 데이터가 입력되었다. 대립가설은 <span class="math inline">\(p_1 &gt; p_2\)</span>이므로 <code>"greater"</code>로 설정되었다.</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="ch:categoricalTest.html#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(<span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">20</span>), <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">300</span>), <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  c(30, 20) out of c(400, 300)
X-squared = 0.075833, df = 1, p-value = 0.3915
alternative hypothesis: greater
95 percent confidence interval:
 -0.02668306  1.00000000
sample estimates:
    prop 1     prop 2 
0.07500000 0.06666667 </code></pre>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>는 기존 공정과 신규 공정이 각각 0.075, 0.0666667이다.</li>
<li>p-값은 0.3915127로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)</li>
</ul>
<p>따라서 신규 공정이 기존 공정보다 불량률이 낮다는 유의미한 통계적 증거는 없다고 할 수 있다.</p>
</div>
<div id="교차표를-이용하여-여러-모집단의-모비율-차이를-검정하기" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> 교차표를 이용하여 여러 모집단의 모비율 차이를 검정하기<a href="ch:categoricalTest.html#교차표를-이용하여-여러-모집단의-모비율-차이를-검정하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:prop-test-course1" class="example"><strong>Example 11.5  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
분반(class)에 따라 여학생 비율에 차이가 있었는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a>는 두 분반의 성별 차이가 있는지를 가설검정하는 것이다. 1분반과 2분반의 여학생 비율을 <span class="math inline">\(p_1\)</span>과 <span class="math inline">\(p_2\)</span>라고 하면 귀무가설과 대립가설은 다음과 같이 설정한다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p_1 = p_2 \\
H_1: &amp; \quad p_1 \neq p_2
\end{align}
\]</span>
<code>prop.test()</code> 함수의 <code>x</code>와 <code>n</code> 인수에 입력할 데이터를 구하려면 분반-성별 교차표를 계산하여야 한다.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="ch:categoricalTest.html#cb880-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcg <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> class <span class="sc">+</span> gender, <span class="at">data =</span> course)</span>
<span id="cb880-2"><a href="ch:categoricalTest.html#cb880-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcg</span></code></pre></div>
<pre><code>     gender
class  F  M
    1 10 12
    2  8 15</code></pre>
<p><code>x</code>는 분반별 여학생의 수이므로 <code>tcg</code>의 첫번째 열이고, <code>n</code>은 분반별 학생 수이므로 <code>tcg</code>의 행별 합이된다. 그러므로 다음처럼 <code>prop.test()</code> 함수를 이용하여 두 분반의 여학생 비율의 차이에 대한 가설검정을 수행할 수 있다.</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="ch:categoricalTest.html#cb882-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(tcg[,<span class="dv">1</span>], <span class="fu">marginSums</span>(tcg, <span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  tcg[, 1] out of marginSums(tcg, 1)
X-squared = 0.18157, df = 1, p-value = 0.67
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.2226672  0.4361059
sample estimates:
   prop 1    prop 2 
0.4545455 0.3478261 </code></pre>
<ul>
<li>여학생의 표본 비율 <span class="math inline">\(\hat{p}\)</span>는 1, 2 분반이 각각 0.4545455, 0.3478261이다.</li>
<li>p-값은 0.6700265로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)</li>
</ul>
<p>따라서 분반별 성별 비율의 차이에 대한 통계적 증거는 없다고 할 수 있다.</p>
<div id="교차표를-직접-인수로-전달하여-가설검정하기" class="section level4 unnumbered hasAnchor">
<h4>교차표를 직접 인수로 전달하여 가설검정하기<a href="ch:categoricalTest.html#교차표를-직접-인수로-전달하여-가설검정하기" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>그런데 모비율의 차이에 대한 가설검정을 하기 위하여 교차표에서 매번 열을 지정하여 <code>x</code>에 전달하고, 행별 합을 구하여 <code>n</code>에 전달하는 작업은 조금 번거로운 작업이다.
<code>prop.test()</code>는 교차표를 첫 번째 인수로 직접 전달받아 모비율의 차이에 대한 가설검정을 수행할 수 있다. 이 때 첫 번째 인수로 전달될 교차표는 다음 조건이 만족되어야 한다.</p>
<ul>
<li>교차표의 행은 모집단을 표현한다. Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a>에서 모집단은 분반이 된다.</li>
<li>교차표의 열은 검정하려는 범주형 변수를 표현해야 한다. Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a>에서 검정하고자 하는 범주형 변수는 성별이다.</li>
<li>교차표는 두 열만을 가져야 한다. 즉, 검정하고자 하는 범주형 변수의 범주는 두 개이어야 한다. Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a>의 범주형 변수는 성별이고 여자(F)와 남자(M)라는 두 변수만 가지고 있다.</li>
<li>모비율을 계산할 때 교차표의 첫 번째 열을 기준으로 계산을 수행한다. 그러므로 교차표 <code>tcg</code>에서는 여자의 비율을 계산하여 가설검정한다. 사실 두 개의 범주만 있는 경우에는 두 범주 중 무엇을 기준으로 계산하는 지는 표본비율에만 영향을 미치지 가설검정의 결과에는 영향을 미치지는 않는다.</li>
</ul>
<p>따라서 모비율 가설검정을 할 때 <code>xtabs()</code>을 이용하여 교차표를 만들 때 다음처럼 교차표를 만들어 가설검정을 수행하면 된다.</p>
<pre><code>교차표_결과 &lt;- xtabs(~ 모집단_구분_변수 + 검정할_범주형_변수, data = 데이터)
prop.test(교차표_결과, alternative = &quot;대립가설_종류&quot;)</code></pre>
<p><code>x</code>와 <code>n</code> 인수에 직접 값을 입력한 결과와 동일한 결과를 주는 것을 확인할 수 있다.</p>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a>은 분반을 각각의 모집단으로 하여 성별 비율의 차이를 검정하는 것이므로 분반이 행, 성별이 열이 되도록 교차표를 만들었다. 그리고 <code>prop.test()</code>는 모집단의 그룹을 행으로, 검정하려는 범주형 변수를 열로 된 교차표를 직접 입력 받아 가설검정을 수행하였다.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="ch:categoricalTest.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcg</span></code></pre></div>
<pre><code>     gender
class  F  M
    1 10 12
    2  8 15</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="ch:categoricalTest.html#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(tcg, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  tcg
X-squared = 0.18157, df = 1, p-value = 0.67
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.2226672  0.4361059
sample estimates:
   prop 1    prop 2 
0.4545455 0.3478261 </code></pre>
<p>만약 Example <a href="ch:categoricalTest.html#exm:prop-test-course1">11.5</a> 범주형 변수의 순서를 변경하여 남자(M)가 첫 번째 열에 나오도록 하여 남자의 모비율을 가지고 가설검정을 하려면 어떻게 해야 할까? <code>factor()</code> 함수를 사용하여 범주형 변수의 범주(<code>levels</code>)의 순서를 바꾼 후 교차표를 만들면 된다.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> (<code>factor()</code>에 대한 자세한 내용은 R 프로그래밍의 <a href="https://kilhwan.github.io/rprogramming/ch-R-Data-Frame.html#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%99%80-%EC%9A%94%EC%9D%B8-factors">범주형 데이터와 요인</a> 절을 참조하기 바란다.) 다음은 남자와 여자의 순서를 바꾸어 교차표를 만든 후 앞의 가설 검정을 다시 수행한 결과이다. p-값 등이 모두 동일하고 단지 여자가 아니라 남자로 표본비율을 계산하였기 때문에 모비율의 추정 값이 달라지는 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="ch:categoricalTest.html#cb889-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcgM <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> class <span class="sc">+</span> <span class="fu">factor</span>(gender, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)), <span class="at">data =</span> course)</span>
<span id="cb889-2"><a href="ch:categoricalTest.html#cb889-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcgM</span></code></pre></div>
<pre><code>     factor(gender, levels = c(&quot;M&quot;, &quot;F&quot;))
class  M  F
    1 12 10
    2 15  8</code></pre>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="ch:categoricalTest.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(tcgM, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  tcgM
X-squared = 0.18157, df = 1, p-value = 0.67
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.4361059  0.2226672
sample estimates:
   prop 1    prop 2 
0.5454545 0.6521739 </code></pre>
</div>
<div id="사례-연구-여러-모집단의-모비율-차이에-대한-가설검정" class="section level4 unnumbered hasAnchor">
<h4>사례 연구: 여러 모집단의 모비율 차이에 대한 가설검정<a href="ch:categoricalTest.html#사례-연구-여러-모집단의-모비율-차이에-대한-가설검정" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="example">
<p><span id="exm:prop-test-BrokenMarriage" class="example"><strong>Example 11.6  </strong></span><code>bizstatp</code> 패키지의 <code>BrokenMarriage</code>는 덴마크 사회 조사국에서 수행한 성별 및 사회적 계급에 따라 이혼 또는 영구적 관계가 깨진 빈도를 측정한 데이터이다. 여성의 경우 사회적 등급(rank)에 따라 이혼 비율이 다른지 유의수준 5% 하에 가설검정 하시오.</p>
</div>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="ch:categoricalTest.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> BrokenMarriage</span></code></pre></div>
<pre><code>   Freq gender rank broken
1    14   male    I    yes
2   102   male    I     no
3    39   male   II    yes
4   151   male   II     no
5    42   male  III    yes
6   292   male  III     no
7    79   male   IV    yes
8   293   male   IV     no
9    66   male    V    yes
10  261   male    V     no
11   12 female    I    yes
12   25 female    I     no
13   23 female   II    yes
14   79 female   II     no
15   37 female  III    yes
16  151 female  III     no
17  102 female   IV    yes
18  557 female   IV     no
19   58 female    V    yes
20  321 female    V     no</code></pre>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-BrokenMarriage">11.6</a>은 다섯 개의 사회적 계급별로 여성의 이혼율이 같은지를 가설검정하는 것으로 <span class="math inline">\(p_i\)</span>를 등급 <span class="math inline">\(i\)</span>의 여성의 이혼율이라고 하면 귀무가설과 대립가설은 다음과 같다. 두 모집단의 경우 대립가설이 <code>모비율이 같지 않다</code>, <code>작다</code>, <code>크다</code>의 세 종류가 있지만 모집단이 3 개 이상이 되면 <code>모비율이 서로 같지 않은 두 집단이 있다</code>라는 한 가지 종류밖에 없다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p_1 = p_2 = \cdots = p_5 \\
H_1: &amp; \quad p_i \neq p_j \text{인 } i, j \text{가 있다. 단, } i, j = 1, 2, \ldots, 5, i \neq j.
\end{align}
\]</span>
<code>prop.test()</code>에 교차표를 전달하여 가설검정을 하려면 교차표의 행이 모집단을 표현하고, 열이 검정하려는 범주형 변수를 표현해야 한다. Example <a href="ch:categoricalTest.html#exm:prop-test-BrokenMarriage">11.6</a>는 사회적 계급을 행으로, 이혼 여부를 열로 교차표를 만들면 된다. <code>BrokenMarriage</code>는 이미 범주별로 관측도수가 요약된 데이터이다. 이렇게 이미 요약된 데이터를 이용하여 빈도표를 만드는 방법은 <a href="ch:categoricalDescStat.html#subsec:BrokenMarriage">7.3.2</a> 절에서 설명한 것처럼 <code>xtabs()</code> 함수의 수식 좌변에 관측도수를 나타내는 열을 지정하는 것이다. 아울러 여자의 이혼률에 대해서만 가설검정하려는 것이므로, <code>subset</code> 인수를 사용하여 성별이 여자인 데이터로 한정하여 교차표를 만들도록 하였다.</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="ch:categoricalTest.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> trb_femail <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> rank <span class="sc">+</span> broken, <span class="at">data =</span> BrokenMarriage, </span>
<span id="cb895-2"><a href="ch:categoricalTest.html#cb895-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                     <span class="at">subset =</span> gender <span class="sc">==</span> <span class="st">&quot;female&quot;</span>)</span>
<span id="cb895-3"><a href="ch:categoricalTest.html#cb895-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> trb_femail</span></code></pre></div>
<pre><code>     broken
rank  yes  no
  I    12  25
  II   23  79
  III  37 151
  IV  102 557
  V    58 321</code></pre>
<p><code>prop.test()</code>를 이용하여 가설검정을 하면 다음과 같은 결과를 얻는다. 이 때 모집단이 3 개 이상이면 <code>모비율이 서로 같지 않은 두 집단이 있다</code>라는 한 종류의 대립가설만 있으므로 <code>alternative</code> 인수는 기술하지 않는다.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="ch:categoricalTest.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(trb_femail)</span></code></pre></div>
<pre><code>
    5-sample test for equality of proportions without continuity correction

data:  trb_femail
X-squared = 11.286, df = 4, p-value = 0.02353
alternative hypothesis: two.sided
sample estimates:
   prop 1    prop 2    prop 3    prop 4    prop 5 
0.3243243 0.2254902 0.1968085 0.1547800 0.1530343 </code></pre>
<ul>
<li>표본 비율 <span class="math inline">\(\hat{p}\)</span>은 사회적 계급 별로 각각 0.3243243, 0.2254902, 0.1968085, 0.15478, 0.1530343이다.</li>
<li>p-값은 0.023535로 유의수준 0.05에서 귀무가설을 기각한다. (대립가설을 채택한다.)</li>
</ul>
<p>따라서 여성의 사회적 계급 별로 이혼율의 차이가 있다고 할 수 있다. 모집단이 세 개 이상인 경우의 모비율의 차이에 대한 가설검정에서 귀무가설이 기각되고 대립가설이 채택되면, 어느 모집단이 전체 데이터의 평균 비율보다 유의미하게 컸는지 작았는지에 대한 분석이 필요하다. 이를 분석하는 방법에 대해서는 카이제곱 검정을 사용하는 독립성 검정에서 논의하도록 한다. 사실 <code>prop.test()</code>도 모비율의 차이에 대한 가설검정을 카이제곱 검정으로 하기 때문에 다음처럼 <code>chisq.test()</code>를 사용해도 동일한 결과를 얻는다. 다만 <code>chisq.test()</code>는 이 검정이 모집단의 모비율에 대한 가설 검정인지 분포에 대한 독립성 검정인지 구분하지 못하므로 표본 비율에 대한 정보는 제공하지 않는다.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="ch:categoricalTest.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">chisq.test</span>(trb_femail)</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  trb_femail
X-squared = 11.286, df = 4, p-value = 0.02353</code></pre>
</div>
</div>
<div id="fisher의-exact-test" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Fisher의 Exact Test<a href="ch:categoricalTest.html#fisher의-exact-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:prop-test-course2" class="example"><strong>Example 11.7  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다. 학년(year)에 따라 여학생 비율에 차이가 있었는지 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-course2">11.7</a>은 학년간 성별 차이가 있는지를 가설검정하는 것으로 각 학년의 여학생 비율을 <span class="math inline">\(p_i\)</span>라고 하면 귀무가설과 대립가설은 다음과 같다.</p>
<p><span class="math display">\[
\begin{align}
H_0: &amp; \quad p_1 = p_2 = p_3 = p_4 \\
H_1: &amp; \quad p_i \neq p_j \text{인 } i, j \text{가 있다. 단, } i, j = 1, 2, 3, 4, i \neq j.
\end{align}
\]</span></p>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-course2">11.7</a>은 학년을 각각의 모집단으로 하여 성별 비율의 차이를 검정하는 것이므로 학년이 행, 성별이 열이 되도록 교차표를 만든다.</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="ch:categoricalTest.html#cb901-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tyg <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> year <span class="sc">+</span> gender, <span class="at">data =</span> course)</span>
<span id="cb901-2"><a href="ch:categoricalTest.html#cb901-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tyg</span></code></pre></div>
<pre><code>    gender
year  F  M
   1  0  1
   2 14 18
   3  3  6
   4  1  2</code></pre>
<p>앞에서 구해진 교차표를 <code>prop.test()</code>고 전달하여 가설검정을 하면 다음 결과를 얻는다.</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="ch:categoricalTest.html#cb903-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">prop.test</span>(tyg)</span></code></pre></div>
<pre><code>Warning in prop.test(tyg): 카이제곱 approximation은 정확하지 않을수도 있습니다</code></pre>
<pre><code>
    4-sample test for equality of proportions without continuity correction

data:  tyg
X-squared = 1.0764, df = 3, p-value = 0.7828
alternative hypothesis: two.sided
sample estimates:
   prop 1    prop 2    prop 3    prop 4 
0.0000000 0.4375000 0.3333333 0.3333333 </code></pre>
<p>그런데 가설검정을 해보면 결과가 정확하지 않을 수 있다는 경고가 나타난다. 여러 모집단의 모비율에 대한 가설검정은 Peason의 카이제곱 검정을 하는데 이 검정 방법은 범주형 변수를 연속형 변수로 근사하여 수행하게 된다. 그리고 한 셀의 관측도수의 기대치가 최소 5 이상이어야만 이러한 근사가 어느 정도 정확할 수 있다. 그런데 Example <a href="ch:categoricalTest.html#exm:prop-test-course2">11.7</a>은 2학년을 제외하고는 다른 셀의 관측도수가 적어서 기대치가 5 미만인 셀이 많다.</p>
<p>이렇듯 교차표의 셀의 관측치가 적은 경우에는 Fisher의 Exact Test를 수행하는 것이 좋다. 단일 모집단의 모비율에 대해 검정할 때 이항분포를 사용하여 정확한 분포로 가설섬정을 할 수 있었던 것과 마찬가지로, Fisher의 Exact Test는 초기하 분포라는 이산형 분포를 사용하여 정확한 가설검정을 수행할 수 있다.</p>
<p><strong>R</strong>에서 Fisher의 Exact Test를 하는 함수<code>fisher.test()</code> 함수이다. <code>prop.test()</code> 함수와 마찬가지로</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="ch:categoricalTest.html#cb906-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">fisher.test</span>(tyg)</span></code></pre></div>
<pre><code>
    Fisher&#39;s Exact Test for Count Data

data:  tyg
p-value = 0.9235
alternative hypothesis: two.sided</code></pre>
<p><code>prop.test()</code>와 달리 표본 비율에 대한 정보는 주지 않는다. p-값은 0.9234755로 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.) 그러므로 학년별로 성별 비율에 차이가 있었다는 통계적 증거는 없었다.</p>
</div>
</div>
<div id="적합성-검정" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> 적합성 검정<a href="ch:categoricalTest.html#적합성-검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>지금까지는 범주형 변수에서 한 범주가 발생하는 비율에 대한 가설검정을 살펴보았다. 성별 변수에서 여학생의 비율, 학년 변수에서 2학년의 비율 등이 그 예라 할 수 있다. 이제부터는 범주형 변수에서 한 범주의 비율이 아니라 전체 범주의 분포에 대하여 가설검정하는 방법을 살펴보자. 즉, 학년 변수에서 특정 학년의 비율이 아니라 전체 학년의 분포에 대해 가설검정을 하는 것이 그 예라 할 수 있다.</p>
<p>적합성 검정(Goodness-of-Fit Test)은 <span class="math inline">\(k\)</span> 개의 범주를 가지는 범주형 변수에 대하여 모집단에서 각 범주의 발생 비율이 특정 값인지 아닌지를 검정한다. 범주형 변수의 <span class="math inline">\(i\)</span>-번째 범주의 모집단에서의 비율을 <span class="math inline">\(p_i\)</span>라고 하자. 단, <span class="math inline">\(i=1, \ldots, k\)</span>. <span class="math inline">\(\sum_{i} p_i = 1\)</span>. 그러면 적합성 검정에서의 귀무가설은 다음과 같다.</p>
<p><span class="math display">\[
H_0: \quad p_1 = p_{10}, \, p_2 = p_{20}, \, \ldots, \, p_k = p_{k0}
\]</span></p>
<p>대립가설 <span class="math inline">\(H_1\)</span>은 ’위의 조건 중 하나 이상이 만족하지 않는다’가 된다.</p>
<p>모집단에서 <span class="math inline">\(n\)</span>개의 표본을 임의로 추출하였을 때, <span class="math inline">\(i\)</span>-번째 범주의 관측치의 수를 나타내는 확률변수를 <span class="math inline">\(X_i\)</span>라고 하자. 그러면 <span class="math inline">\(\sum_{i=1}^{k} X_i = n\)</span>이고, 귀무가설이 맞다면 표본 분포는 다음과 같은 다항분포를 따른다.</p>
<p><span class="math display">\[
(X_1, X_2, ..., X_k) \sim \text{multinomial}(n, p_{10}, p_{20}, .... p_{k0})
\]</span></p>
<p>표본의 크기가 <span class="math inline">\(n\)</span>일 때 범주 별 관측도수 <span class="math inline">\((X_1, X_2, ..., X_k)\)</span>가 다항분포를 따르면, 다음처럼 정의되는 검정통계량 <span class="math inline">\(X^2\)</span>는 자유도 <span class="math inline">\((k-1)\)</span>의 카이제곱 분포로 근사적으로 따른다고 알려져 있다.</p>
<p><span class="math display">\[
X^2 = \sum_{i=1}^{k} \frac{[X_i-E(X_i)]^2}{E(X_i)} = \sum_{i=1}^{k} \frac{[X_i- n \, p_{i0}]^2}{n \, p_{i0}}.
\]</span>
즉,</p>
<p><span class="math display">\[
X^2 \sim \chi^2(k-1).
\]</span></p>
<p>그런데 이러한 근사 방법이 잘 작동하려면 각 범주의 기대 관측도수 <span class="math inline">\(E(X_i) = n p_i\)</span>가 5 이상이어야 한다. 이보다 작으면 근사의 정확도가 떨어진다.</p>
<p>귀무가설이 맞는다면 표본의 각 범주의 실제 관측도수 <span class="math inline">\(x_i\)</span>가 기대치 <span class="math inline">\(n \, p_i\)</span>와 가까워지고, 그렇지 않으면 차이가 나게 된다. 따라서 귀무가설의 조건이 성립하지 않으면 <span class="math inline">\(X^2\)</span> 값이 커지게 된다. 따라서 적합성 검정은 카이제곱 분포를 이용하여 오른쪽 단측검정으로 가설검정을 수행한다.</p>
<div class="example">
<p><span id="exm:goodness1" class="example"><strong>Example 11.8  </strong></span>3가지 색상으로 구성된 제품이 판매되고 있다.
고객이 특별히 선호하는 색상은 없고 동일한 비율로 판매된다는 가설에 대해 검정하고자 한다.
시험적으로 판매된 <span class="math inline">\(n=90\)</span>개 판매 데이터를 분석해 보니, 각 색상별 판매량이 <span class="math inline">\(x_1 = 23, x_2 = 36, x_3 = 31\)</span>로 집계되었다.
유의수준 5%에서 가설검정을 하시오.</p>
</div>
<p>세가지 색상의 고객 선호 비율을 각각 <span class="math inline">\(p_1, p_2, p_3\)</span>라고 하면 귀무가설과 대립가설은 다음과 같다.</p>
<p><span class="math display">\[
\begin{align}
H_0: \quad &amp; p_1 = p_2 = p_3 = 1/3\\
H_1: \quad &amp; p_i \neq 1/3 \, \text{ for some } \, i.
\end{align}
\]</span></p>
<p><strong>R</strong>에서는 <code>chisq.test()</code> 함수를 이용하면 적합성 검정을 한다.</p>
<pre><code>chisq.test(x = 범주별_관측도수, p = 범주별_비율)
chisq.test(x = 범주별_관측도수, p = 범주별_비율, rescale.p, correct)</code></pre>
<ul>
<li><code>x</code>: 각 범주별 관측치 수를 나타내는 벡터 또는 빈도표</li>
<li><code>p</code>: 적합성 검정을 할 때 사용할 귀무가설 하의 범주별 비율을 나타내는 벡터</li>
<li><code>rescale.p</code>: <code>p</code>의 합이 1이 아닐 때, 1이 되도록 스케일을 조정할지를 결정하는 논리값 인수</li>
<li><code>correct</code>: 연속성 수정을 할지를 결정하는 논리값 인수</li>
</ul>
<p>이 외에도 카이제곱 확률분포를 사용한 가설검정이 아니라 몬테 카를로 시뮬레이션을 이용한 가설검정을 할 때 사용하는 <code>simulation.p.value</code>와 <code>B</code> 인수가 있다. 이에 대해서는 뒤에 설명을 하겠다.</p>
<p>다음은 Example <a href="ch:categoricalTest.html#exm:goodness1">11.8</a>의 카이제곱 검정 결과이다. 기본적으로 출력되는 정보뿐 아니라 상세 정보를 이용하기 위해 결과를 변수에 할당한 후 출력하였다.</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="ch:categoricalTest.html#cb909-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">36</span>, <span class="dv">31</span>), <span class="at">p=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb909-2"><a href="ch:categoricalTest.html#cb909-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Chi-squared test for given probabilities

data:  c(23, 36, 31)
X-squared = 2.8667, df = 2, p-value = 0.2385</code></pre>
<p>위의 예에서는 p-value가 0.2385126가 나와 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)</p>
<p><code>chisq.test()</code>를 수행한 결과를 변수에 저장하면 화면에 출력되지 않은 상세한 정보를 나중에 확인할 수 있다. 어떠한 상세 정보를 제공하는지 확인하려면 <code>names()</code> 함수를 이용하여 변수에 저장된 요소의 이름을 출력해 본다.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="ch:categoricalTest.html#cb911-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(result)</span></code></pre></div>
<pre><code>[1] &quot;statistic&quot; &quot;parameter&quot; &quot;p.value&quot;   &quot;method&quot;    &quot;data.name&quot; &quot;observed&quot; 
[7] &quot;expected&quot;  &quot;residuals&quot; &quot;stdres&quot;   </code></pre>
<p><code>chisq.test()</code>의 결과 중에서 중요한 요소가 <code>observed</code>, <code>expected</code>, <code>residuals</code>, <code>stdres</code>이다.</p>
<ul>
<li><code>observed</code>는 각 범주별 관측 개수이다.</li>
<li><code>expected</code> 는 귀무가설 하에서 각 범주별 관측 개수의 기대치이다.</li>
<li><code>residuals</code>은 <span class="math inline">\([x_i-E(x_i)]/\sqrt{E(x_i)}\)</span>의 값이다. 따라서 residual을 제곱하여 다 더하면 <span class="math inline">\(X^2\)</span>가 된다.</li>
<li><code>stdres</code>는 표준화된 잔차로 <span class="math inline">\([x_i-E(x_i) ]/SE( x_i-E(x_i) )\)</span>로 셀의 관측값이 커지면 정규분포에 근사된다.</li>
</ul>
<p><code>chisq.test()</code>의 결과의 각 요소를 출력하려면, <code>출력결과$요소</code>의 명령을 사용하면 된다.</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="ch:categoricalTest.html#cb913-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>observed</span></code></pre></div>
<pre><code>[1] 23 36 31</code></pre>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="ch:categoricalTest.html#cb915-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>[1] 30 30 30</code></pre>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="ch:categoricalTest.html#cb917-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>residuals</span></code></pre></div>
<pre><code>[1] -1.2780193  1.0954451  0.1825742</code></pre>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="ch:categoricalTest.html#cb919-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>stdres</span></code></pre></div>
<pre><code>[1] -1.5652476  1.3416408  0.2236068</code></pre>
<p><code>stdres</code>를 살펴보면 귀무가설을 기각하게 만드는데 기여한 셀이 무엇인지 확인할 수 있다.</p>
<ul>
<li>일반적으로 한 범주의 <code>stdres</code>의 절대값이 2보다 크면 그 셀의 관측치가 귀무가설 하의 기대치에서 크게 차이가 난 것으로, 3이상이면 차이가 매우 크게 난 것으로 판단한다.</li>
<li><code>stdres</code> 값이 양수이면 관측치가 귀무가설 하의 기대치에 비해 컸다는 것이며, 음수이면 관측치가 귀무가설 하의 기대치보다 작았다는 것이다.</li>
<li>여기서 주의할 점은 귀무가설이 맞더라도 표준화된 잔차의 절대값이 2이상일 확률은 정규분포 하에서 약 5%가 된다. 따라서 20개의 범주가 있다면 귀무가설이 맞더라도 표준화된 잔차의 절대값이 2 이상이 되는 셀이 평균적으로 1개 정도는 나타나게 된다. 따라서 귀무가설의 채택과 기각 여부는 p-값으로 판단해야지 <code>stdres</code>로 판단해서는 안된다.</li>
</ul>
<p>Example <a href="ch:categoricalTest.html#exm:goodness1">11.8</a>의 예에서는 귀무가설을 기각하지 못했고 모든 범주에 대해 <code>stdres</code>의 값이 <span class="math inline">\(\pm 2\)</span> 구간 안에 있으므로 각 범주별 표본의 관측 개수가 기대치를 크게 벗어나지 않았다.</p>
<div class="example">
<p><span id="exm:goodness2" class="example"><strong>Example 11.9  </strong></span>어느 지역에서 발생하는 하루 동안의 교통사고 수 <span class="math inline">\(Y\)</span>를 <span class="math inline">\(n=50\)</span>일간 조사하였다.
조사한 결과 다음과 같은 결과를 얻었다.
교통사고 수 <span class="math inline">\(Y\)</span>가 <span class="math inline">\(\lambda = 1/2\)</span>인 포아송 분포를 따르는지에 대해서 유의수준 5%에서 가설검정 하시오.</p>
</div>
<table>
<thead>
<tr class="header">
<th align="left">y</th>
<th align="right">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">2 이상</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>귀무가설과 대립가설은 다음과 같다.
<span class="math display">\[
\begin{align}
H_0: \quad &amp; Y \sim Poisson(1/2) \\
H_1: \quad &amp; Y \text{는 Poisson(1/2) 분포를 따르지 않는다.}
\end{align}
\]</span></p>
<p>귀무가설 하의 사고가 하루에 0번, 1번, 2번 이상 일어날 확률을 다음처럼 <span class="math inline">\(p_1, p_2, p_3\)</span>라고 하자.</p>
<p><span class="math display">\[p_1 = P(Y=0), \,  p_2=P(Y=1), \, p_3 = P(Y \ge 2).\]</span>
그러면 귀무가설 하의 <span class="math inline">\(p_1, p_2, p_3\)</span>는 다음처럼 포아송 분포의 확률질량함수를 이용하여 구할 수 있다.</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="ch:categoricalTest.html#cb921-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb921-2"><a href="ch:categoricalTest.html#cb921-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), lambda), <span class="fu">ppois</span>(<span class="dv">1</span>, lambda, <span class="at">lower.tail=</span>F)); p</span></code></pre></div>
<pre><code>[1] 0.60653066 0.30326533 0.09020401</code></pre>
<p><code>chisq.test()</code> 함수로 가설검정을 수행하면 다음 결과를 얻는다.</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="ch:categoricalTest.html#cb923-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">12</span>, <span class="dv">6</span>), <span class="at">p=</span>p); result</span></code></pre></div>
<pre><code>Warning in chisq.test(c(32, 12, 6), p = p): 카이제곱 approximation은 정확하지
않을수도 있습니다</code></pre>
<pre><code>
    Chi-squared test for given probabilities

data:  c(32, 12, 6)
X-squared = 1.2444, df = 2, p-value = 0.5368</code></pre>
<p>위의 예에서는 p-value가 0.5367749가 나와 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.) 그러므로 교통사고가 포아송 분포가 아니라는 통계적 증거는 없었다.</p>
<p>그러나 마지막 셀의 기대치가 5 미만이어서 가설검정에 정확성에 대한 경고가 출력되었다.</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="ch:categoricalTest.html#cb926-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>[1] 30.326533 15.163266  4.510201</code></pre>
<p>만약 <span class="math inline">\(\lambda\)</span>가 주어져 있지 않으면, 최우추정법(Maximum Likelihood Estimate)를 이용하여 <span class="math inline">\(\lambda\)</span>를 추정해야 하고, 이 경우 <span class="math inline">\(\chi^2\)</span> 분포의 자유도가 1 감소하게 된다. 이러한 경우에도 <strong>R</strong>을 사용하여 가설검정을 수행할 수 있는데, 이에 대한 설명은 이 교재의 범위를 넘어가므로 설명을 생략하도록 한다.</p>
<div id="빈도표를-이용한-적합성-검정" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> 빈도표를 이용한 적합성 검정<a href="ch:categoricalTest.html#빈도표를-이용한-적합성-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:goodness-course" class="example"><strong>Example 11.10  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
학년(year)별 수강 신청 비율이 0.05, 0.6, 0.25, 0.1이라는 귀무가설에 대하여 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>Example <a href="ch:categoricalTest.html#exm:goodness-course">11.10</a>에서 각 학년의 수강생 비율을 <span class="math inline">\(p_i\)</span>라고 하면 귀무가설은 다음과 같다.</p>
<p><span class="math display">\[
H_0: \quad p_1 = 0.05, \, p_2 = 0.6, \, p_3 = 0.25, \, p_4 = 0.1
\]</span></p>
<p>학년별 수강생의 절대 빈도표와 상대 빈도표를 구하면 다음과 같다.</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="ch:categoricalTest.html#cb928-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ty <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> year, <span class="at">data =</span> course)</span>
<span id="cb928-2"><a href="ch:categoricalTest.html#cb928-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ty</span></code></pre></div>
<pre><code>year
 1  2  3  4 
 1 32  9  3 </code></pre>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="ch:categoricalTest.html#cb930-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">proportions</span>(ty)</span></code></pre></div>
<pre><code>year
         1          2          3          4 
0.02222222 0.71111111 0.20000000 0.06666667 </code></pre>
<p><code>chisq.test()</code>로 가설검정을 하면 다음의 결과를 얻는다.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="ch:categoricalTest.html#cb932-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(ty, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.6</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>Warning in chisq.test(ty, p = c(0.05, 0.6, 0.25, 0.1)): 카이제곱 approximation은
정확하지 않을수도 있습니다</code></pre>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="ch:categoricalTest.html#cb934-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Chi-squared test for given probabilities

data:  ty
X-squared = 2.5704, df = 3, p-value = 0.4627</code></pre>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="ch:categoricalTest.html#cb936-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>    1     2     3     4 
 2.25 27.00 11.25  4.50 </code></pre>
<p>그러나 1학년과 4학년의 기대 관측도수가 5보다 작아서 가설검정의 정확성에 대한 경고가 출력되었다.</p>
</div>
<div id="몬테-카를로-시뮬레이션을-이용한-적합도-가설검정" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> 몬테 카를로 시뮬레이션을 이용한 적합도 가설검정<a href="ch:categoricalTest.html#몬테-카를로-시뮬레이션을-이용한-적합도-가설검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Example <a href="ch:categoricalTest.html#exm:goodness-course">11.10</a>는 기대 관측도수가 5보다 작은 범주가 있으므로 카이제곱 검정의 정확도가 떨어진다. 단일모집단의 모비율 검정에서 이항분포를 사용하면 정확한 검정을 할 수 있는 것과 마찬가지로 적합도 검정을 원래의 정확한 분포인 다항분포를 사용하여 수행하면 기대 관측도수가 작더라도 정확한 가설검정을 수행할 수 있다. 그러나 다항분포를 이용하여 p-값을 계산하는 것은 매우 강도 높은 계산량을 요구한다. 그래서 다항분포의 식을 이용하여 p-값을 직접 구하기보다는 몬테 카를로 시뮬레이션을 이용하여 p-값을 구한다.</p>
<p><span class="math inline">\(n\)</span>개의 표본을 임의로 추출하였을 때 귀무가설 하에 범주의 관측도수 <span class="math inline">\((x_1, x_2, \dots, x_k)\)</span>는 다항분포 <span class="math inline">\(\text{multinomial}(n, p_{10}, p_{20}, .... p_{k0})\)</span>를 따른다. 몬테 카를로 시뮬레이션은 다항분포를 따르는 관측도수 <span class="math inline">\((x_1, x_2, \dots, x_k)\)</span>를 <code>B</code> 번 시뮬레이션을 구한다. 그리고 이 <code>B</code> 번의 시뮬레이션 값 중에서 현재 관측된 관측도수보다 더 예외적인 결과가 나온 시뮬레이션 횟수를 구하여 p-값을 추정한다. 예를 들어 <span class="math inline">\(B=1000\)</span>번 시뮬레이션 했는데, 이 중 25 번의 결과가 현재 관측된 값보다 더 예외적인 값이라면 현재 관측된 값보다 예외적인 값이 나올 확률은 <span class="math inline">\(25 / 1000 = 2.5\)</span> %라고 추정한다.</p>
<p><code>chisq.test()</code> 함수가 근사적인 카이제곱 분포가 아니라 다항분포를 몬테 카를로 시뮬레이션 하여 p-값을 구하게 하려면 <code>simulate.p.value = TRUE</code>로 설정하면 된다. 시뮬레이션 횟수는 2,000번으로 설정되어 있다. 인수 <code>B</code>를 설정하면 시뮬레이션 횟수를 조정할 수 있다.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="ch:categoricalTest.html#cb938-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(ty, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.6</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>), </span>
<span id="cb938-2"><a href="ch:categoricalTest.html#cb938-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                      <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb938-3"><a href="ch:categoricalTest.html#cb938-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Chi-squared test for given probabilities with simulated p-value (based
    on 2000 replicates)

data:  ty
X-squared = 2.5704, df = NA, p-value = 0.4618</code></pre>
<p>위의 예에서는 p-value가 0.4617691가 나와 유의수준 0.05에서 귀무가설을 채택한다. (대립가설을 기각한다.)
앞에서 근사적으로 카이제곱 분포로 p-값을 구한 결과와 큰 차이를 보이지는 않았다.</p>
</div>
</div>
<div id="독립성-검정" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> 독립성 검정<a href="ch:categoricalTest.html#독립성-검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>독립성 검정은 어떤 두 범주형 변수가 독립인지 아닌지를 검정한다.
첫 번째 범주형 변수에 <span class="math inline">\(R\)</span>개의 범주가 있고, 두 번째 범주형 변수에 <span class="math inline">\(C\)</span>개의 범주가 있다고 하자.
그러면 두 범주형 변수와 관련된 교차표 또는 분할표는 <span class="math inline">\(R \times C\)</span> 행렬로 표현된다.</p>
<table>
<colgroup>
<col width="22%" />
<col width="14%" />
<col width="14%" />
<col width="15%" />
<col width="15%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">범주</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center"><span class="math inline">\(\cdots\)</span></th>
<th align="center">C</th>
<th align="center">합계</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center"><span class="math inline">\(x_{11}\)</span></td>
<td align="center"><span class="math inline">\(x_{12}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(x_{1C}\)</span></td>
<td align="center"><span class="math inline">\(r_1\)</span></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center"><span class="math inline">\(x_{21}\)</span></td>
<td align="center"><span class="math inline">\(x_{22}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(x_{2C}\)</span></td>
<td align="center"><span class="math inline">\(r_2\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\ddots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td align="center">R</td>
<td align="center"><span class="math inline">\(x_{R1}\)</span></td>
<td align="center"><span class="math inline">\(x_{R2}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(x_{RC}\)</span></td>
<td align="center"><span class="math inline">\(r_R\)</span></td>
</tr>
<tr class="odd">
<td align="center">합계</td>
<td align="center"><span class="math inline">\(c_{1}\)</span></td>
<td align="center"><span class="math inline">\(c_{2}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(c_{C}\)</span></td>
<td align="center"><span class="math inline">\(n\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(n\)</span>을 전체 관측도수, <span class="math inline">\(x_{ij}\)</span>를 i행-j열 셀의 관측도수라고 하자. 그리고 <span class="math inline">\(r_i\)</span>와 <span class="math inline">\(c_j\)</span>를 각각 i 행과 j 열의 관측도수의 합이라고 하자. 그러면 독립성 검정의 검정통계량 <span class="math inline">\(X^2\)</span>은 다음과 같다.</p>
<p><span class="math display">\[
X^2 = \sum_{i=1}^{R} \sum_{j=1}^{C} \frac{[x_{ij} - E(x_{ij})]^2}{E(x_{ij})}
    = \sum_{i=1}^{R} \sum_{j=1}^{C} \frac{[(x_{ij} - r_i \, c_j / n)]^2}{r_i \, c_j / n}
\]</span></p>
<p>그리고 검정통계량 <span class="math inline">\(X^2\)</span>는 자유도 <span class="math inline">\((R-1) (C-1)\)</span>의 카이제곱 분포를 따른다.</p>
<p><span class="math display">\[
X^2 \sim \chi^2((R-1)(C-1)).
\]</span></p>
<p>적합성 검정과 마찬가지로 두 변수의 독립성 가정이 참이면 각 셀의 관측도수 <span class="math inline">\(x_{ij}\)</span>와 귀무가설 하의 각 셀의 기대관측치 <span class="math inline">\(r_i \, c_j / n\)</span>의 차이가 크지 않고, 거짓이면 차이가 커지게 된다. 따라서 독립성 검정도 <span class="math inline">\(X^2\)</span>이 예외적으로 커지면 대립가설을 받아들이므로 오른쪽 단측검정을 한다.</p>
<p>Example <a href="ch:categoricalTest.html#exm:prop-test-BrokenMarriage">11.6</a>에서는 사회 계급에 따라 여성의 이혼 비율에 대해 가설검정한 것이지만, 여성의 사회적 계급(rank)과 이혼 여부(broken)라는 두 변수의 독립성을 검정하는 문제로 보고 카이제곱 검정을 수행할 수도 있다.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="ch:categoricalTest.html#cb940-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> trb_femail</span></code></pre></div>
<pre><code>     broken
rank  yes  no
  I    12  25
  II   23  79
  III  37 151
  IV  102 557
  V    58 321</code></pre>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="ch:categoricalTest.html#cb942-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(trb_femail)</span>
<span id="cb942-2"><a href="ch:categoricalTest.html#cb942-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  trb_femail
X-squared = 11.286, df = 4, p-value = 0.02353</code></pre>
<p>그런데 앞서서 p-값이 0.023535로 유의수준 0.05보다 작으므로 귀무가설이 기각된다고만 하고, 귀무가설이 기각된 이유에 대한 분석을 하지 않았다. 제대로 된 분석을 하려면 귀무가설이 기각되는 경우 어떠한 요인이 귀무가설을 기각하게 만들었는지를 살펴보아야 한다. 적합성 검정과 마찬가지로 <code>stdres</code>은 귀무가설이 맞다고 할 때 각 셀의 실제 관측도수가 기대 관측도수에서 얼마나 크게 벗어났는지를 알려준다.</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="ch:categoricalTest.html#cb944-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>stdres</span></code></pre></div>
<pre><code>     broken
rank        yes        no
  I    2.534424 -2.534424
  II   1.552177 -1.552177
  III  1.055350 -1.055350
  IV  -1.442944  1.442944
  V   -1.032415  1.032415</code></pre>
<p>결과에서 보듯이 사회 계급 별로 이혼 여부의 차이를 만든 두드러진 요인은 사회 계급이 1등급인 여성이 전체 평균에 비해 이혼한 경우(yes)는 더 많고 이혼 하지 않은 경우(no)는 더 적었기 때문이었다. 그 다음으로 전체적인 이혼 추세에서 벗어난 계급은 2등급 여성과 4등급 여성이었다. 2등급은 1등급만큼은 아니지만 이혼 비율이 평균적인 이혼 비율보다 높았고, 4등급은 이혼 비율이 평균보다 낮았다.</p>
<div class="example">
<p><span id="exm:independence-Arthritis" class="example"><strong>Example 11.11  </strong></span><code>bizstatp</code>에 포함된 <code>Arthritis</code> 데이터에서 치료의 종류(<code>Treatment</code>)와 증상 개선 효과(<code>Improved</code>)가 서로 독립인지 유의수준 5% 하에 가설검정하시오.</p>
</div>
<p><code>Arthritis</code> 데이터에서 치료의 종류와 개선 효과에 대해 교차표를 구하면 다음과 같다.</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="ch:categoricalTest.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tti <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> Treatment <span class="sc">+</span> Improved, <span class="at">data =</span> Arthritis)</span>
<span id="cb946-2"><a href="ch:categoricalTest.html#cb946-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tti</span></code></pre></div>
<pre><code>         Improved
Treatment None Some Marked
  Placebo   29    7      7
  Treated   13    7     21</code></pre>
<p><code>chisq.test()</code> 함수를 이용하여 독립성 검정을 하면 다음과 같은 결과를 얻는다.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="ch:categoricalTest.html#cb948-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tti)</span>
<span id="cb948-2"><a href="ch:categoricalTest.html#cb948-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  tti
X-squared = 13.055, df = 2, p-value = 0.001463</code></pre>
<p>위의 예에서는 p-value가 0.0014626가 나와 유의수준 0.05에서 귀무가설을 기각한다. (대립가설을 채택한다.) 즉, 치료법이 플라시보인지 진짜 치료인지에 따라 증상 개선에 차이가 있었다.</p>
<p>그러면 귀무가설을 기각시킨 주요 요인이 무엇인지 확인해 보자. 아래 결과를 보면, 플라시보 치료군에서는 귀무가설이 맞다고 할 때 기대되는 관측도수에 비해 증상 개선 없음(None)이 훨씬 많았고, 증상의 확실한 개선(Marked)은 훨씬 적었다. 반면 진짜 치료는 귀무가설이 맞다고 할 때 기대되는 관측도수에 비해 증상 개선 없음(None)이 훨씬 적었고, 증상의 확실한 개선(Marked)은 훨씬 많았다.</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="ch:categoricalTest.html#cb950-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>stdres</span></code></pre></div>
<pre><code>         Improved
Treatment        None        Some      Marked
  Placebo  3.27419655 -0.09761768 -3.39563632
  Treated -3.27419655  0.09761768  3.39563632</code></pre>
<div class="example">
<p><span id="exm:independence-course" class="example"><strong>Example 11.12  </strong></span><code>course</code> 데이터는 어떤 과목의 수강생에 대한 정보이다.
학년(year) 분포와 분반(class)의 분포는 서로 독립이라는 귀무가설에 대하여 유의수준 5%에서 가설검정하시오.</p>
</div>
<p>교차표와 카이제곱 검정을 이용하여 가설검정을 하면 다음 결과를 얻는다.</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="ch:categoricalTest.html#cb952-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcy <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> class <span class="sc">+</span> year, <span class="at">data =</span> course)</span>
<span id="cb952-2"><a href="ch:categoricalTest.html#cb952-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tcy</span></code></pre></div>
<pre><code>     year
class  1  2  3  4
    1  0 18  3  1
    2  1 14  6  2</code></pre>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="ch:categoricalTest.html#cb954-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tcy)</span></code></pre></div>
<pre><code>Warning in chisq.test(tcy): 카이제곱 approximation은 정확하지 않을수도 있습니다</code></pre>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="ch:categoricalTest.html#cb956-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  tcy
X-squared = 2.8125, df = 3, p-value = 0.4214</code></pre>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="ch:categoricalTest.html#cb958-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> result<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>     year
class         1        2   3        4
    1 0.4888889 15.64444 4.4 1.466667
    2 0.5111111 16.35556 4.6 1.533333</code></pre>
<p>2학년을 제외한 모든 셀의 기대 관측도수가 5 이하여서 카이제곱 분포를 사용한 가설검정이 적절하지 않기 때문에 경고 메시지가 출력되었다. 독립성 검정에서 셀의 기대 관측도수가 5 이하여서 경고가 나오는 경우에는 <code>fisher.test()</code> 함수를 이용하여 독립성에 대하여 Fisher의 Exact Test를 수행하는 것이 좋다.</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="ch:categoricalTest.html#cb960-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">fisher.test</span>(tcy)</span></code></pre></div>
<pre><code>
    Fisher&#39;s Exact Test for Count Data

data:  tcy
p-value = 0.4427
alternative hypothesis: two.sided</code></pre>
<p>그런데 <code>fisher.test()</code>도 셀이 너무 많아지면 p-값 계산 시간이 많이 소요된다. 이러한 경우는 <code>chisq.test()</code>와 마찬가지 방식으로 몬테 카를로 시뮬레이션으로 p-값을 계산할 수 있다. Example <a href="ch:categoricalTest.html#exm:independence-course">11.12</a>는 그러한 경우는 아니지만 예제 삼아 몬테 카를로 시뮬레이션을 이용하여 p-값을 구해보자. 정확한 분포로 구한 결과와 시뮬레이션 결과에 큰 차이가 없음을 볼 수 있다.</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="ch:categoricalTest.html#cb962-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">fisher.test</span>(tcy, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
    Fisher&#39;s Exact Test for Count Data with simulated p-value (based on
    2000 replicates)

data:  tcy
p-value = 0.4498
alternative hypothesis: two.sided</code></pre>
<p>몬테 카틀로 시뮬레이션으로 독립성 검정을 하려면 <code>chisq.test()</code> 함수를 사용하여도 된다. 두 함수 모두 동일한 방식으로 시뮬레이션을 하여 p-값을 구한다. 다만 시뮬레이션 결과가 매번 다르므로 p-값은 실행할 때마다 다를 수 있다. 다음은 동일한 시뮬레이션 값이 나오도록 시드를 동일하게 한 후 두 함수의 결과를 비교한 것이다. 시뮬레이션 결과가 동일하면 p-값이 동일함을 확인할 수 있다.</p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="ch:categoricalTest.html#cb964-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb964-2"><a href="ch:categoricalTest.html#cb964-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">chisq.test</span>(tcy, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  tcy
X-squared = 2.8125, df = NA, p-value = 0.4598</code></pre>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="ch:categoricalTest.html#cb966-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb966-2"><a href="ch:categoricalTest.html#cb966-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">fisher.test</span>(tcy, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
    Fisher&#39;s Exact Test for Count Data with simulated p-value (based on
    2000 replicates)

data:  tcy
p-value = 0.4598
alternative hypothesis: two.sided</code></pre>
</div>
<div id="범주형-변수의-가설검정에-대한-정리" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> 범주형 변수의 가설검정에 대한 정리<a href="ch:categoricalTest.html#범주형-변수의-가설검정에-대한-정리" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>그림 <a href="ch:categoricalTest.html#fig:categorical-test">11.1</a>은 지금까지 살펴본 범주형 변수에 대한 여러 가지 가설검정의 차이점을 도식화하여 분류한 것이다. 범주형 변수의 가설검정은 크게 범주 하나의 비율에 대한 것인지 아니면 모든 범주에 대한 분포에 대한 것인지에 따라 나뉘어진다. 그리고 한 범주의 비율에 대한 검정은 하나의 모집단에서의 모비율에 대한 검정인지, 여러 모집단의 모비율의 차이에 대한 것인지에 따라 다시 나뉘어진다. 분포 검정도 마찬가지로 하나의 범주형 변수의 분포에 대한 것인지, 두 범주형 변수의 분포의 관계를 검정하는 것인지에 따라 적합성 검정과 독립성 검정으로 나뉘어진다.</p>
<p>각각의 검정은 범주에 대한 기대 관측도수가 충분히 크면-주로 5 이상이면-표준정규분포나 카이제곱 분포 등의 연속형 분포로 근사하여 가설검정을 하고, 기대 관측도수가 충분히 크지 않으면 이항분포, 다항분포, 초기하 분포 등의 이산형 분포를 이용하여 가설검정을 수행한다. 이산형 분포를 이용하는 경우 계산량이 많이 필요할 수 있다. 이 경우 분포를 직접 계산하기 보다는 몬테 카를로 시뮬레이션으로 p-값을 구한다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:categorical-test"></span>
<img src="img/categorical-test.png" alt="범주형 변수의 가설검정의 종류와 사용해야 할 R 함수" width="75%" />
<p class="caption">
Figure 11.1: 범주형 변수의 가설검정의 종류와 사용해야 할 R 함수
</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>이미 요인으로 변경된 범주형 변수는 <code>relevel()</code> 함수를 사용하여 첫 번째 범주를 더 쉽게 지정할 수 있다. 관심 있는 독자는 도움말을 참조하기 바란다.<a href="ch:categoricalTest.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch:hypoTest.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch:numericTest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bizStatistics.pdf", "bizStatistics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
